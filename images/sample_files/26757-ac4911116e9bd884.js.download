"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[26757],{226757:function(e,t,r){let n;r.d(t,{W:function(){return ry}});var i=r(867932),s=r(652983),o=r(918458),a=r(945368),l=r(394580),c=r(40643),d=r(205609),u=r(670296),p=r(590862),m=r(677609),h=r(121256),g=r(214243),f=r(397458);let y=({showResolved:e,updateFilterOptions:t})=>{let r=e=>{t({status:e?void 0:"open"})};return(0,f.jsx)(u.u,{placement:"top-start",label:e?g.T.HideResolvedComments:g.T.ShowResolvedComments,children:(0,f.jsx)(p.z,{onClick:()=>r(!e),variant:"minimal",size:"sm","aria-label":e?g.T.HideResolvedComments:g.T.ShowResolvedComments,leftIcon:e?(0,f.jsx)(m.b,{}):(0,f.jsx)(h.c,{}),children:g.T.Resolved})})};var j=r(751004),v=r(41792),b=r(939817),x=r(202958),O=r(15239),w=r(873794),C=r(771504);let P=({defaultSort:e,isPublic:t,setSort:r,onSortSelect:n})=>{let{0:i,1:o}=(0,s.useState)(e),a=[{value:"newest",label:g.T.Newest,type:"date",direction:"desc"},{value:"oldest",label:g.T.Oldest,type:"date",direction:"asc"}],l=[{value:"timecode",label:g.T.TimeCode,type:"time_code",direction:"asc"}];t||(a=[...a,...l]);let c=e=>{o(e.label);let t={value:e.value,label:e.label,type:e.type,direction:e.direction};r(t),n?.(t)};return(0,s.useEffect)(()=>{r({value:"newest",label:g.T.Newest,type:"date",direction:"desc"}),o(g.T.Newest)},[t]),(0,f.jsx)(j.xu,{children:(0,f.jsxs)(v.v,{placement:"bottom",children:[(0,f.jsx)(u.u,{label:g.T.Sort,placement:"top",children:(0,f.jsx)(b.j,{onFocus:e=>e.preventDefault(),as:p.z,variant:"minimal",size:"sm",rightIcon:(0,f.jsx)(C.W,{}),children:i})}),(0,f.jsx)(x.q,{background:"background",children:(0,f.jsx)(O._,{defaultValue:i,value:i,title:g.T.SortBy,textColor:"text-secondary",children:a.map(e=>(0,f.jsx)(w.i,{value:e.label,onClick:()=>c(e),children:e.label},e.label))})})]})})};var k=r(496777),R=r(530679),I=r(932460);let S=({filterOptions:e,updateFilterOptions:t,isLoggedOut:r})=>{let n="everyone"!=e.userType||e.mentionAndReplies;return(0,f.jsxs)(v.v,{children:[(0,f.jsx)(u.u,{placement:"top",label:g.T.Filter,children:(0,f.jsx)(b.j,{onFocus:e=>e.preventDefault(),as:k.h,variant:n?"primary":"minimal",size:"sm","aria-label":"Filter comments",icon:(0,f.jsx)(I.w,{})})}),(0,f.jsxs)(x.q,{background:"background",children:[!r&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)(O._,{title:`${g.T.ShowFrom}:`,textColor:"text-secondary",defaultValue:"everyone",value:e.userType,onChange:e=>t({userType:e}),children:[(0,f.jsx)(w.i,{value:"everyone",children:g.T.Everyone}),(0,f.jsx)(w.i,{value:"team",children:g.T.OnlyFromTeam}),(0,f.jsx)(w.i,{value:"non_team",children:g.T.OnlyGuests})]}),(0,f.jsx)(R.R,{})]}),(0,f.jsx)(O._,{value:e.mentionAndReplies?.toString(),children:(0,f.jsx)(w.i,{value:"true",onClick:()=>t({mentionAndReplies:!e.mentionAndReplies}),children:g.T.MentionsAndReplies})})]})]})};var E=r(692584),T=r(29607),D=r(602156),N=r(292154),$=r(646653),_=r(35773),L=r(439136),A=r(141259),F=r(722893),z=r(86549),K=r(112756),M=r(192740),U=r(810464),Z=r(274518),V=r(139813),B=r(496751),J=r(291017),q=r(441312),H=r(295449),G=r(218784),Y=r(567313),Q=r(839698),W=r(530651),X=r(771534),ee=r(64095),et=r(416188);let er=({textDecoration:e,setPreviewClip:t})=>{let r=e.assets?.video,{0:n,1:i}=(0,s.useState)(!0);return r&&(0,Z.Pd)(r.uri)?(0,f.jsxs)(j.xu,{children:[(0,f.jsxs)(l.k,{py:"4px",children:[(0,f.jsx)(d.x,{overflow:"hidden",variant:"body-md",children:`"${r.name}"`}),(0,f.jsx)(k.h,{px:"4px",ml:"4px",size:"xs",variant:"minimal","aria-label":"show-preview",onClick:()=>i(!n),icon:(0,f.jsx)(ee._,{transform:`rotate(${n?0:-90}deg)`,transition:"transform 0.3s ease"})})]}),(0,f.jsx)(E.M,{children:n&&(0,f.jsxs)(l.k,{position:"relative",as:T.E.div,direction:"column",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto",transition:{type:"tween"}},exit:{opacity:0,height:0},onClick:()=>{t(r)},children:[(0,f.jsx)(W.E,{src:r.pictures?.sizes?.[1]?.link,fallbackSrc:"https://i.vimeocdn.com/video/default_295x166.jpg",alt:"comment video link thumbnail"}),(0,f.jsx)(X.M,{height:"100%",width:"100%",position:"absolute",children:(0,f.jsx)(k.h,{"aria-label":"preview-play",background:"gray.50",icon:(0,f.jsx)(et.s,{})})})]})})]}):null},en=({setPreviewClip:e,textDecorations:t})=>(0,f.jsx)(f.Fragment,{children:t.map((t,r)=>(0,f.jsx)(er,{textDecoration:t,setPreviewClip:e},r))});var ei=r(853106),es=r(343831),eo=r(974145),ea=r(274133),el=r(462481),ec=r(242145),ed=r(680353),eu=r(855998),ep=r(295152),em=r(435746);function eh(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function eg(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?eh(Object(r),!0).forEach(function(t){(0,i.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eh(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let ef=e=>{let t=0,r=[];return e.descendants((e,n)=>{if(["text","mention"].includes(e.type.name)){let i="text"===e.type.name?e.text||"":e.attrs.label;r[t]?(r[t].text+=i,r[t].nodePositions.push({pos:n,type:e.type.name,text:i})):r[t]={text:`${i}`,nodePositions:[{pos:n,type:e.type.name,text:i}]}}else t+=1}),r=r.filter(Boolean)},ey=(e,t)=>{let r=[];for(let n of Array.from(e.matchAll(t)).filter(([e])=>e.trim())){if(""===n[0])break;void 0!==n.index&&r.push({startIndex:n.index,length:n[0].length,endIndex:n.index+n[0].length})}return r},ej=(e,t)=>{let r=[],n=[];return e.forEach(e=>{let{from:i,to:s,pos:o,type:a}=e;if("text"===a){let e=em.p.inline(o+i,o+s,{class:t,nodeName:"mark"});r.push(e)}else"mention"===a&&n.push({from:i,to:s,pos:o})}),{nonMentionResults:r,mentionResults:n}},ev=(e=null,t,r,n)=>{if(!t||!e)return{nonMentionResults:em.EH.empty,mentionResults:[]};let i=ef(e),s=[];i.forEach(e=>{let{text:r,nodePositions:i}=e,o=ey(r,t);if(0===o.length)return{nonMentionResults:em.EH.empty,mentionResults:[...n]};let a=r.length*o.length,l=0,c=0,d=0,u=0,p=0;for(;l<r.length&&d<i.length&&!(c>=o.length)&&!(p>a);){let e=o[c]||{},{pos:t,type:r,text:n}=i[d],a=e.startIndex+u;if(e.startIndex!==e.endIndex&&e.endIndex<=a||u>=e.length){c++,u=0;continue}if(a<l+n.length){let i=a-l,o=e.endIndex-l>n.length?n.length:e.endIndex-l;s.push({from:i,to:o,pos:t,type:r}),u+=o-i,i===o&&u++}else d++,l+=n.length;p++}});let{nonMentionResults:o,mentionResults:a}=ej(s,r);return{nonMentionResults:em.EH.create(e,o),mentionResults:[...n,...a]}},eb=eu.hj.create({name:"searchHighlight",addOptions:()=>({searchHighlightClass:"highlighted-text"}),addStorage:()=>({searchTerm:"",mentionResults:[],lastSearchTerm:""}),addCommands:()=>({setSearchTerm:e=>({editor:t})=>(t.storage.searchHighlight.searchTerm=e,!1)}),addProseMirrorPlugins(){let e=this.editor,{searchHighlightClass:t}=this.options,r=t=>e.storage.searchHighlight.lastSearchTerm=t;return[new ep.Sy({key:new ep.H$("searchHighlightPlugin"),state:{init:()=>em.EH.empty,apply({doc:n,docChanged:i},s){let{searchTerm:o,lastSearchTerm:a,mentionResults:l}=e.storage.searchHighlight;if(!i&&a===o)return s;r(o);let c=(l||[]).map(e=>eg(eg({},e),{},{from:void 0,to:void 0}));if(!o)return e.storage.searchHighlight.mentionResults=[...c],e.storage.searchHighlight.searchTerm="",em.EH.empty;let{nonMentionResults:d,mentionResults:u}=ev(n,RegExp(String(o).replace(/[\\^$*+?.()|[\]{}]/g,"\\$&"),"gui"),t,c);return e.storage.searchHighlight.mentionResults=u,d}},props:{decorations(e){return this.getState(e)}}})]}});function ex(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function eO(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ex(Object(r),!0).forEach(function(t){(0,i.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ex(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let ew=({text:e="",editedTime:t,isResolved:r,searchQuery:n})=>{let i=(0,s.useMemo)(()=>{try{return JSON.parse(e)}catch(e){return}},[e]),o=(0,ec.jE)({editable:!1,extensions:[es.Z,el.Z,ea.Z,ei.ZP,eo.Z,eb.configure({searchHighlightClass:"highlighted-text"}),ed.Z],content:i});(0,s.useEffect)(()=>{i&&setTimeout(()=>{o?.chain().setContent(i).run()},0)},[i,o]),(0,s.useEffect)(()=>{o&&o.commands.setSearchTerm(n||"")},[n,o]),(0,s.useEffect)(()=>{if(o){let e=o.storage.searchHighlight?.mentionResults??[],t=o.state.tr;e.forEach(e=>{let{from:r,to:n,pos:i}=e,s=t.doc.nodeAt(i);t.setNodeMarkup(i,null,eO(eO({},s?.attrs),{},{highlight:{from:r,to:n}}))}),o.view.dispatch(t.setTime(Date.now()))}},[o?.storage?.searchHighlight?.mentionResults?.length]);let a=(0,s.useMemo)(()=>({".rich-comment-viewer":{display:"inline",fontSize:"text-sm",color:"text-primary"},".ProseMirror":{paddingLeft:0,display:"inline",p:{display:"inline"},".highlighted-text":{backgroundColor:"orange.100"},".highlighted-mention-text":eO({backgroundColor:"orange.100"},r?{color:"gray.900",opacity:1}:{color:"fill-brand"})}}),[r]);return o?(0,f.jsxs)(j.xu,{display:"inline",sx:a,children:[(0,f.jsx)(ec.kg,{className:"rich-comment-viewer",editor:o}),(0,f.jsx)(eC,{editedTime:t})]}):null},eC=(0,s.memo)(({editedTime:e})=>e?(0,f.jsx)(u.u,{placement:"top",label:(0,Z.jF)(e),children:(0,f.jsx)(d.x,{display:"inline",color:"text-secondary",variant:"body-md",children:` (${g.T.Edited})`})}):null);var eP=r(61423),ek=r(113690),eR=r(410281);let eI="staffpicked",eS=({id:e,user:t,createdTime:r,editedTime:n,timeCode:i,formattedTimeCode:a,text:l,replies:c,isReply:m,onEditClick:h,onDeleteClick:y,onCopyClick:O,onReplyClick:w,isOwnComment:C,isOwnVideo:P,activeReplyId:R,isDeeplinkedComment:I=!1,isRichComment:S=!1,canAddComments:E=!0,onOpenCommentOptionsClick:T,isUserProfileClickable:N,onUserProfileClick:$,status:_,toggleCommentStatus:A,canResolveComment:F=!1,textDecorations:z,setPreviewClip:K,onMomentPlay:M,isBeingEdited:U,parentCommentId:W,searchQuery:X,isPreviousVersion:ee=!1,onReportClick:et,videoPrivacy:er,isPublic:ei})=>{let{0:es,1:eo}=(0,s.useState)(!1),ea="closed"===_,[el,ec]=(0,Z.gp)(t?.pictures?.sizes),ed=R&&R===e,eu=c&&c.length>0,ep=!m&&!ed&&!U&&!eu&&E,em=C||P,eh=C&&(E||ee)&&!ea,eg=function(){let e=(0,eR.R)(),t=e?.vuid??0,{assignment:r}=(0,eP.CZ)({flagKey:"video-comment-reporting",subject:{key:t,keyType:ek.B7.VUID},defaultAssignment:"control",assignmentType:ek.Ib.STRING});return r}(),ef=ei&&"anybody"===er&&!C&&void 0!==et&&"variant"===eg,ey=O&&!ee,ej=(0,s.useRef)(null),ev=(0,o.pm)(),eb=()=>{$?.(e,!!m,t?.id||"")};(0,s.useEffect)(()=>{setTimeout(()=>I&&ej.current?.scrollIntoView({behavior:"smooth",block:"nearest"}),500)},[I]);let ex=t?.isStaffPicked?eI:t?.badge,eO=(0,s.useRef)(null),{0:eC,1:eS}=(0,s.useState)(!1);return(0,s.useEffect)(()=>{let e=eO.current;if(!e)return;let t=new ResizeObserver(()=>{eS(e.scrollWidth>e.clientWidth)});return t.observe(e),()=>{e&&t.disconnect()}},[eO]),(0,s.useEffect)(()=>()=>(0,Z.d$)(e,!1)),(0,f.jsxs)(L.U,{spacing:75,align:"flex-start",mx:"8px",px:{base:"8px",md:"16px"},py:75,role:"group","data-testid":"comment",ref:I?ej:null,onClick:()=>{i&&M(i)},id:`comment_${e.split("/").pop()}`,onMouseEnter:()=>{i&&(0,Z.d$)(e)},onMouseLeave:()=>{i&&(0,Z.d$)(e,!1)},borderRadius:"md",sx:{"p, span, img, strong":{opacity:"closed"===_?.5:void 0},"strong, strong span, strong span p":{opacity:"closed"===_?1:void 0},"&.is--highlighted":{backgroundColor:"var(--vimeo-colors-fill-component-hover)"}},_hover:{cursor:i?"pointer":"default",background:"fill-component-hover"},children:[t?.link&&N?(0,f.jsx)("a",{onClick:eb,href:t?.link,"aria-label":"Link to user profile",children:(0,f.jsx)(V.q,{"data-testid":"avatar",alt:"User avatar",src:el,srcSet:ec,size:"sm",style:{height:"2rem"}})}):(0,f.jsx)(V.q,{"data-testid":"avatar",alt:"User avatar",src:el,srcSet:ec,size:"sm",style:{height:"2rem"}}),(0,f.jsxs)(D.g,{spacing:75,minW:0,align:"stretch",flex:1,children:[(0,f.jsxs)(L.U,{spacing:75,mb:"-8px",children:[t?.link&&N?(0,f.jsx)("a",{onClick:eb,href:t?.link,"aria-label":"Link to user profile",style:{minWidth:0},children:(0,f.jsx)(u.u,{placement:"top",isDisabled:!eC,label:t?.name,children:(0,f.jsx)(d.x,{variant:"heading-xs",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",ref:eO,color:"text-primary",children:t?.name})})}):(0,f.jsx)(u.u,{placement:"top",isDisabled:!eC,label:t?.name,children:(0,f.jsx)(d.x,{ref:eO,variant:"heading-xs",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:"text-primary",children:t?.name})}),"alum"===ex&&(0,f.jsx)(B.C,{variant:ex,size:"sm",children:g.T.Alum}),"staff"===ex&&(0,f.jsx)(B.C,{variant:ex,size:"sm",children:g.T.Staff}),t&&t.uri&&ex===eI&&(0,f.jsx)(Y.n,{href:"/watch",videoId:parseInt(e,10),userUri:t.uri,feature:"comments",marginRight:0}),(0,f.jsx)(j.xu,{children:(0,f.jsx)(u.u,{placement:"top",label:(0,Z.jF)(r),children:(0,f.jsx)(d.x,{variant:"body-sm",as:"span",whiteSpace:"nowrap",flexGrow:1,color:"text-primary",children:(0,Q.Zh)(new Date(r),{shorten:!0})})})}),(eh||ey||em)&&(0,f.jsxs)(v.v,{onOpen:()=>{T?.(e,!!m,t?.id||"",!!i),eo(!0)},onClose:()=>eo(!1),children:[(0,f.jsx)(b.j,{as:k.h,"aria-label":"Options",icon:(0,f.jsx)(q.V,{}),variant:"minimal",size:"xs",ml:"auto",opacity:{base:1,md:es?1:0},_groupHover:{opacity:1},_focus:{opacity:1},"data-testid":"comment-menu-button"}),(0,f.jsxs)(x.q,{background:"background",minW:"169px",children:[eh?(0,f.jsx)(J.s,{onClick:()=>h(e),children:g.T.Edit}):null,ey?(0,f.jsx)(J.s,{onClick:()=>{O(e,t?.id||"",!!i,W,l),ev({duration:2e3,title:g.T.LinkCopied})},children:g.T.CopyLink}):null,ef?(0,f.jsx)(J.s,{onClick:()=>et(e.split("/").pop()),children:g.T.Report}):null,em?(0,f.jsx)(J.s,{onClick:()=>y(e),children:g.T.Delete}):null]})]}),_&&!m&&F&&!ee&&(0,f.jsx)(u.u,{placement:"top-end",label:ea?g.T.ReOpen:g.T.MarkAsResolved,children:(0,f.jsx)(k.h,{"data-testid":"resolve","aria-label":"Comment status",variant:"minimal",size:"xs",icon:ea?(0,f.jsx)(H.r,{}):(0,f.jsx)(G.n,{}),onFocus:e=>e.preventDefault(),opacity:{base:1,md:ea?1:0},_groupHover:{opacity:1},_focus:{opacity:1},onClick:()=>A?.(e,_),ml:"-8px"})})]}),!U&&(0,f.jsxs)(j.xu,{children:[a&&(0,f.jsx)(B.C,{variant:"timestamp",size:"sm",mr:"8px",children:a}),S?(0,f.jsx)(ew,{text:l,editedTime:n,isResolved:ea,searchQuery:X}):(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(d.x,{display:"inline",variant:"body-md",children:l}),n&&(0,f.jsx)(u.u,{placement:"top",label:(0,Z.jF)(n),children:(0,f.jsx)(d.x,{display:"inline",color:"text-secondary",variant:"body-md",children:` (${g.T.Edited})`})})]}),Array.isArray(z)&&(0,f.jsx)(en,{setPreviewClip:K,textDecorations:z})]}),ep&&!ee&&(0,f.jsx)(L.U,{spacing:50,children:(0,f.jsx)(p.z,{variant:"secondary",size:"xs",onClick:()=>w?.(e),children:g.T.Reply})})]})]})};var eE=r(855116);let eT=({isDeeplinkedComment:e=!1})=>{let t=(0,s.useRef)(null);return(0,s.useEffect)(()=>{if(!e)return;let r=setTimeout(()=>{t.current?.scrollIntoView({behavior:"smooth",block:"nearest"})},500);return()=>clearTimeout(r)},[e]),(0,f.jsxs)(L.U,{spacing:75,align:"flex-start",px:{base:200,md:300},py:75,role:"group","data-testid":"comment",ref:e?t:null,children:[(0,f.jsx)(j.xu,{backgroundColor:"fill-component",boxSize:"sm",borderRadius:"50%",display:"flex",justifyContent:"center",alignItems:"center",children:(0,f.jsx)(eE.N,{m:"4px",boxSize:"20px"})}),(0,f.jsx)(D.g,{spacing:75,minW:0,align:"stretch",flex:1,children:(0,f.jsx)(L.U,{spacing:75,children:(0,f.jsx)(N.n,{size:"md",color:"text-secondary",p:"6px 0",children:g.T.DeletedComment})})})]})};var eD=r(401169);let eN=({w:e="100%",h:t="2xs"})=>(0,f.jsx)(eD.O,{w:e,h:t,borderRadius:"pill",bgSize:"200%"}),e$=({w:e="md",h:t="md"})=>(0,f.jsx)(eD.O,{w:e,h:t,borderRadius:"round",bgSize:"200%"}),e_=({opacity:e="100%"})=>(0,f.jsxs)(L.U,{px:{base:200,md:300},py:100,align:"stretch",w:"100%",opacity:e,children:[(0,f.jsx)(e$,{}),(0,f.jsxs)(D.g,{spacing:75,flex:1,align:"stretch",children:[(0,f.jsx)(eN,{w:"90%"}),(0,f.jsx)(eN,{w:"100%"}),(0,f.jsx)(eN,{w:"70%"})]})]}),eL=()=>(0,f.jsxs)(D.g,{flexGrow:1,align:"stretch",spacing:75,pt:200,overflow:"hidden",w:"100%",h:"100%",children:[(0,f.jsx)(e_,{opacity:"100%"}),(0,f.jsx)(e_,{opacity:"100%"}),(0,f.jsx)(e_,{opacity:"80%"}),(0,f.jsx)(e_,{opacity:"40%"}),(0,f.jsx)(e_,{opacity:"20%"})]});var eA=r(929871),eF=r(710559),ez=r(662555);let eK=({errorMessage:e="",isPublic:t,onSubmit:r,editingText:n="",autoFocus:i=!1,onCancel:o,shouldShowCancel:a=!1,submitButtonText:l=g.T.SubmitComment,isLoading:c=!1,richCommentComponent:d,commentContextFields:u,setDraftText:m,isGuestModalActive:h=!1,isDisabled:y=!1})=>{let v=(0,s.useRef)(null),b=(0,s.useRef)({}),{0:x,1:O}=(0,s.useState)(!1),{0:w,1:C}=(0,s.useState)(n),P=()=>{O(!0),d&&b?.current?.focusEnd()},k=()=>{b?.current?.onSubmit?.(),r?.(w),m?.("")};(0,s.useEffect)(()=>{c&&C(""),c||n||e||(b?.current?.clearContent?.(),O(!1),b?.current?.removeFocus?.())},[c,e]);let R=()=>{m?.(a?"":w),O(!1),o?.()};return(0,eA.O)({enabled:!h,ref:v,handler:R}),(0,f.jsxs)(j.xu,{w:"100%",ref:v,children:[d?(0,f.jsx)(d,{autoFocus:i,richtext:w,isExpanded:x,isPublic:t,placeholder:g.T.InputPlaceholder,setCommentText:e=>C(e),onFocus:P,richtextAreaRef:b,commentContextFields:u,onSubmitComment:r,isPostCommentLoading:c,isDisabled:y}):(0,f.jsx)(eF.g,{w:"100%",mb:0,size:"sm",rows:x?3:1,onFocus:P,placeholder:g.T.InputPlaceholder,value:w,onChange:e=>C(e.target.value),autoFocus:i,resize:"none",isInvalid:!!e,onKeyDown:e=>{"Enter"!==e.key||(!e.shiftKey&&w.trim()?(e.preventDefault(),k(),e.target.blur()):e.shiftKey||e.preventDefault())}}),x?(0,f.jsxs)(L.U,{gap:"100",justifyContent:"space-between",alignItems:"center",children:[e?(0,f.jsx)(N.n,{size:"sm",color:"status-destructive-primary",py:8,children:e}):(0,f.jsx)(j.xu,{fontSize:12,opacity:.6,py:8,color:"text-tertiary",children:n?null:(0,ez.Iu)({singular:"Use @ to mention others",dictionary:{es:{singular:"Use @ para mencionar a otros"},"de-DE":{singular:"Verwende @, um andere zu erw\xe4hnen"},"fr-FR":{singular:"Utilisez @ pour mentionner d'autres personnes"},"ja-JP":{singular:"他のユーザーにコメントするには @ を使用します"},"ko-KR":{singular:"다른 사람을 언급하려면 @를 사용하세요."},"pt-BR":{singular:"Use @ para mencionar outros usu\xe1rios"}}})}),(0,f.jsxs)(L.U,{children:[a?(0,f.jsx)(p.z,{variant:"minimal",size:"sm",onClick:R,children:g.T.Cancel}):null,(0,f.jsx)(p.z,{variant:"primary",type:"submit",isLoading:c,size:"sm",onClick:k,isDisabled:d?!b?.current?.commentLength():!w.trim(),children:(0,f.jsx)("span",{children:l})})]})]}):null]})},eM="40px",eU=({comment:e,isPublic:t,addReply:r,editComment:n,editReply:i,deleteComment:o,deleteReply:a,isSubmitTextLoading:c=!1,isDeleteLoading:u=!1,deeplinkedCommentId:m,isMoreCommentsLoading:h=!1,lastElementRef:y,onCopyClick:v,canAddComments:b=!0,richCommentComponent:x,onOpenCommentOptionsClick:O,isUserProfileClickable:w,onUserProfileClick:P,replyError:k,editCommentError:R,editReplyError:I,onMomentPlay:S,toggleCommentStatus:D,canResolveComment:N,setPreviewClip:$,searchQuery:V,isGuestModalActive:B,isPreviousVersion:J=!1,onReportClick:q,videoPrivacy:H})=>{let{0:G,1:Y}=(0,s.useState)(!0),{0:Q,1:W}=(0,s.useState)(""),{0:X,1:ee}=(0,s.useState)(""),{0:et,1:er}=(0,s.useState)(""),{0:en,1:ei}=(0,s.useState)(""),[es,eo]=(0,_.dQ)("space",["200","300"]),{0:ea,1:el}=(0,s.useState)(""),ec=e.replies&&e.replies.length>0,ed=Q&&Q===e.id,eu=b&&!ed,ep=!!m&&e.id.includes(m),em=!!m&&e.replies?.some(e=>m&&e.id.includes(m)),eh=()=>{Q&&W(""),X&&ee("")},eg=e=>{ei(e)},ef=()=>{er(""),ei("")},ey=e=>{Q&&r(Q,e)},ej=e=>{X&&i(X,e)};(0,s.useEffect)(()=>{(ep||em)&&"number"==typeof e?.timeCode&&S(e.timeCode)},[e?.timeCode,ep,S,em]),(0,s.useEffect)(()=>{!u&&(et||en)&&ef()},[u]);let ev=X&&e.id===R?.errorCommentId?R.errorMessage:"",eb=Q&&e.id===k?.errorCommentId?k.errorMessage:"",ex=X&&(R||I)||Q&&k,eO=!!e.deletedOn;(0,s.useEffect)(()=>{c||ex||eh()},[c]);let ew={base:`calc(${es} + ${eM})`,md:`calc(${eo} + ${eM})`},eC=X===e.id;return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)(l.k,{ref:y||void 0,direction:"column",backgroundColor:ep||em?"fill-component":"transparent",_hover:{backgroundColor:"fill-secondary"},children:[eO?(0,f.jsx)(eT,{isDeeplinkedComment:ep}):(0,f.jsx)(eS,{id:e.id,user:e.user,createdTime:e.createdTime,text:e.text,timeCode:e.timeCode,formattedTimeCode:e.formattedTimeCode,replies:e.replies,isOwnComment:e.isOwnComment,isOwnVideo:e.isOwnVideo,activeReplyId:Q,editedTime:e.editedTime,onDeleteClick:e=>{er(e)},onCopyClick:v,onEditClick:e=>ee(e),onReplyClick:e=>W(e),isDeeplinkedComment:ep,isRichComment:e.isRichComment,canAddComments:b,onOpenCommentOptionsClick:O,isUserProfileClickable:w,onUserProfileClick:P,status:e.status,toggleCommentStatus:D,canResolveComment:N,textDecorations:e.textDecorations,setPreviewClip:$,isBeingEdited:eC,onMomentPlay:S,searchQuery:V,isPreviousVersion:J,onReportClick:q,videoPrivacy:H,isPublic:t}),ed&&!ec||eC?(0,f.jsx)(j.xu,{ml:ew,pr:{base:200,md:300},pb:100,mt:X?"-8px":0,children:(0,f.jsx)(eK,{isLoading:c,isPublic:t,autoFocus:!0,onCancel:eh,onSubmit:X?e=>{X&&n(X,e)}:ey,editingText:X?e.text:ea,shouldShowCancel:eC,submitButtonText:X?g.T.SaveEdit:g.T.SubmitComment,richCommentComponent:x,setDraftText:el,commentContextFields:{commentId:X?(0,Z.Pd)(X):(0,Z.Pd)(e.id),isReply:!X,existingReplyCounts:e.replies?.length||0,isEdit:!!X,isTimeCoded:!!e.timeCode},errorMessage:X?ev:eb,isGuestModalActive:B})}):null,ec?(0,f.jsx)(L.U,{ml:ew,spacing:50,children:(0,f.jsx)(p.z,{onClick:()=>Y(e=>!e),size:"xs",rightIcon:(0,f.jsx)(C.W,{transform:`rotate(${G?180:0}deg)`,transition:"transform 0.3s ease"}),variant:"minimal",children:g.T.RepliesToggle(e.replies?.length??0)})}):null,(0,f.jsx)(E.M,{children:G&&ec?(0,f.jsxs)(l.k,{as:T.E.div,direction:"column",ml:ew,borderLeft:"1px solid",borderColor:"stroke","data-testid":"replies-container",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto",transition:{type:"tween"}},exit:{opacity:0,height:0},overflow:"hidden",children:[e.replies?.map((r,n)=>{let i=!!(m&&r.id.substring(r.id.lastIndexOf("/")+1).includes(m)),o=r.id===I?.errorCommentId?I.errorMessage:"",a=X===r.id,l=n===(e.replies?.length??0)-1;return f.jsxs(s.Fragment,{children:[f.jsx(eS,{isDeeplinkedComment:i,id:r.id,user:r.user,createdTime:r.createdTime,text:r.text,isOwnComment:r.isOwnComment,isOwnVideo:r.isOwnVideo,editedTime:r.editedTime,isReply:!0,isRichComment:r.isRichComment,activeReplyId:Q,onEditClick:e=>ee(e),onDeleteClick:eg,onCopyClick:v,onOpenCommentOptionsClick:O,isUserProfileClickable:w,onUserProfileClick:P,status:e.status,canAddComments:b,textDecorations:r.textDecorations,setPreviewClip:$,isBeingEdited:a,onMomentPlay:S,parentCommentId:e.id,searchQuery:V,isPreviousVersion:J,onReportClick:q,videoPrivacy:H,isPublic:t}),ed&&ec&&l||a?f.jsx(j.xu,{pl:"8px",pr:{base:200,md:300},pb:100,children:f.jsx(eK,{isLoading:c,isPublic:t,autoFocus:!0,onCancel:eh,onSubmit:X?ej:ey,editingText:X?r.text:ea,setDraftText:el,shouldShowCancel:a,submitButtonText:X?g.T.SaveEdit:g.T.SubmitComment,commentContextFields:{commentId:Z.Pd(Q)??Z.Pd(e.id),isReply:!0,existingReplyCounts:e.replies?.length||0,isEdit:!!X},richCommentComponent:x,errorMessage:X?o:eb,isGuestModalActive:B})}):null]},r.id)}),eu&&!X&&!J&&(0,f.jsx)(L.U,{children:(0,f.jsx)(p.z,{variant:"secondary",size:"xs",mt:"4px",ml:"63px",mb:"8px",onClick:()=>W(e.id),children:g.T.Reply})})]}):null}),h&&(0,f.jsx)(eL,{})]},e.id),(0,f.jsxs)(A.u,{isOpen:!!et||!!en,onClose:ef,isCentered:!0,children:[(0,f.jsx)(F.Z,{}),(0,f.jsxs)(z.h,{width:"482px",maxWidth:"calc(100vw - 32px)",height:"180px",children:[(0,f.jsx)(K.x,{children:(0,f.jsx)(d.x,{textAlign:"left",fontSize:"20px",children:g.T.ConfirmDelete})}),(0,f.jsx)(M.f,{}),(0,f.jsx)(U.m,{children:(0,f.jsxs)(L.U,{children:[(0,f.jsx)(p.z,{variant:"minimal",onClick:ef,children:g.T.Cancel}),(0,f.jsx)(p.z,{isLoading:u,variant:"destructive",onClick:et?()=>{o(et,!!e?.timeCode)}:()=>{a(en,!!e?.timeCode)},children:(0,f.jsx)("span",{children:g.T.Delete})})]})})]})]})]})};var eZ=r(969409);let eV=({isFilter:e,onClearClick:t})=>{let r=e?(0,f.jsx)(I.w,{boxSize:"lg"}):(0,f.jsx)(eZ.X,{boxSize:"lg"}),n=e?g.T.ClearFilters:g.T.DifferentSearch;return(0,f.jsxs)(D.g,{px:{base:200,md:300},flexGrow:1,align:"center",justify:"center","data-testid":"comments-no-match-placeholder",children:[r,(0,f.jsx)(d.x,{variant:"heading-md",color:"text-primary",children:g.T.NoMatchingResults}),(0,f.jsx)(d.x,{as:e?"u":"text",variant:"body-sm",fontSize:"14px",fontWeight:"350",cursor:e?"pointer":"default",color:"text-secondary",onClick:()=>{t?.()},children:n})]})};var eB=r(316667);let eJ=({saveViewerCommentsSetting:e,canAddComments:t,hasComments:r,isPublic:n,hasOnlyCommentAccess:i,isPreviousVersion:s=!1})=>(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(eB.$,{boxSize:r?"sm":"lg",color:"text-primary"}),(0,f.jsx)(d.x,{variant:"heading-xs",fontWeight:"350",textAlign:"center",color:"text-secondary",children:s?r?void 0:g.T.NoCollaboratorsComment:t?n?e?g.T.NoViewersCommentYet:g.T.NoComments:g.T.NoCollaboratorsCommentYet:e?g.T.ViewersCanNotPostNewComments:g.T.NoCommentsAllowed}),e&&!t&&!i&&(0,f.jsx)(p.z,{variant:"primary",size:r?"xs":"sm",onClick:()=>e(!t),children:g.T.AllowComments})]});var eq=r(767269),eH=r(147054),eG=r(510067);let eY=({previewClip:e,onPlayerReady:t,height:r,width:n})=>{let i=(0,s.useRef)(null),{player:o}=(0,eG.Z)(i,(0,Z.Pd)(e.uri),!0,e.embedPlayerConfigUrl??"",!1);return(0,s.useEffect)(()=>{o?.ready&&o.ready(()=>{t(),o.play()})},[o,t]),(0,f.jsx)(j.xu,{position:"relative",height:(0,eq.h)(r),width:(0,eq.h)(n),children:(0,f.jsx)(j.xu,{ref:i,className:"player js-player"})})},eQ=({previewClip:e,setPreviewClip:t})=>{let{0:r,1:n}=(0,s.useState)(!1),{height:i,width:o}=eW(e.width/e.height);return(0,f.jsxs)(A.u,{isOpen:!!e,onClose:()=>t(null),size:"lg",children:[(0,f.jsx)(F.Z,{width:"100%",height:"100%"}),(0,f.jsx)(z.h,{borderRadius:"0",width:(0,eq.h)(o),height:(0,eq.h)(i),maxW:(0,eq.h)(o),children:(0,f.jsxs)(M.f,{padding:"0",borderRadius:"0",children:[!r&&(0,f.jsx)(X.M,{height:"100%",width:"100%",position:"absolute",borderRadius:"sm",overflow:"hidden",children:(0,f.jsx)(eH.$,{size:"lg"})}),(0,f.jsx)(eY,{previewClip:e,onPlayerReady:()=>n(!0),height:i,width:o})]})})]})},eW=e=>{let t,r;let n=window.innerWidth-72,i=window.innerHeight-72;if(e>1)t=(r=700>n?n:700)/e;else{let s=700>i?i:700,o=s*e;o>n?(r=n,t=s/o*n):(r=o,t=s)}return{height:t,width:r}},eX=({comments:e,isPublic:t,addReply:r,editComment:n,editReply:i,deleteComment:o,deleteReply:a,isCommentsLoading:c=!1,isSubmitTextLoading:d=!1,isDeleteLoading:u=!1,deeplinkedCommentId:p,isMoreCommentsLoading:m,canAddComments:h=!0,lastElementRef:y,onCopyClick:j,richCommentComponent:v,onOpenCommentOptionsClick:b,isUserProfileClickable:x,onUserProfileClick:O,commentsFetchingError:w=!1,editCommentError:C,editReplyError:P,replyError:k,onMomentPlay:R,toggleCommentStatus:I,canResolveComment:S,searchQuery:_,appliedFilter:L,clearFilters:A,saveViewerCommentsSetting:F,isGuestModalActive:z,hasOnlyCommentAccess:K,isPreviousVersion:M=!1,onReportClick:U,videoPrivacy:Z})=>{let{0:V,1:B}=(0,s.useState)();return c?(0,f.jsx)(eL,{}):w?(0,f.jsxs)(D.g,{flexGrow:1,align:"center",justify:"center","data-testid":"comments-error",children:[(0,f.jsx)($.o,{}),(0,f.jsx)(N.n,{color:"text-secondary",size:"md",children:g.T.CommentsLoadingError})]}):(!e||0===e.length)&&(_||L)?(0,f.jsx)(eV,{isFilter:!!L,onClearClick:L?A:void 0}):e&&0!==e.length?(0,f.jsxs)(l.k,{direction:"column",overflowX:"auto",flexGrow:1,py:50,"data-testid":"comments-list",children:[V&&(0,f.jsx)(eQ,{previewClip:V,setPreviewClip:B}),(0,f.jsx)(E.M,{children:e.map((s,l)=>{let c=e.length-1===l;return(0,f.jsx)(T.E.div,{animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{type:"tween"},children:(0,f.jsx)(eU,{comment:s,isPublic:t,addReply:r,editComment:n,onCopyClick:j,editReply:i,deleteComment:o,deleteReply:a,isSubmitTextLoading:d,isDeleteLoading:u,deeplinkedCommentId:p,isMoreCommentsLoading:c&&m,lastElementRef:c?y:void 0,canAddComments:h,richCommentComponent:v,onOpenCommentOptionsClick:b,isUserProfileClickable:x,onUserProfileClick:O,editCommentError:C,editReplyError:P,replyError:k,onMomentPlay:R,toggleCommentStatus:I,canResolveComment:S,setPreviewClip:B,searchQuery:_,isGuestModalActive:z,isPreviousVersion:M,onReportClick:U,videoPrivacy:Z})},s.id)})})]}):(0,f.jsx)(D.g,{px:{base:200,md:300},flexGrow:1,align:"center",justify:"center","data-testid":"comments-placeholder",children:(0,f.jsx)(eJ,{canAddComments:h,saveViewerCommentsSetting:F,hasComments:!1,isPublic:t,hasOnlyCommentAccess:K,isPreviousVersion:M})})},e0={commentId:-1,isReply:!1,existingReplyCounts:0},e1=({onSubmit:e,isLoading:t,isPublic:r,canAddComments:n=!0,hasComments:i,richCommentComponent:s,errorMessage:o="",saveViewerCommentsSetting:a,isGuestModalActive:l,hasOnlyCommentAccess:c,isPreviousVersion:d=!1})=>!n&&i?(0,f.jsx)(D.g,{p:200,align:"center",justify:"center",children:(0,f.jsx)(eJ,{canAddComments:n,saveViewerCommentsSetting:a,hasComments:!0,isPublic:r,hasOnlyCommentAccess:c,isPreviousVersion:d})}):n?(0,f.jsx)(j.xu,{p:{base:200,md:"8px 16px"},children:(0,f.jsx)(eK,{richCommentComponent:s,isLoading:t,isPublic:r,onSubmit:e,commentContextFields:e0,errorMessage:o,isGuestModalActive:l,isDisabled:d})}):null;var e2=r(628463),e5=r(543437),e6=r(656703),e9=r(800741),e3=r(502349),e4=r(92575),e7=r(996240);let e8=["baseUrl","select","variables","where","query"];function te(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function tt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?te(Object(r),!0).forEach(function(t){(0,i.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):te(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}async function tr(e){let{baseUrl:t,select:r,variables:n,where:{albumId:i,videoId:s,commentId:o},query:a}=e,l=(0,e4.Z)(e,e8),c=await fetch(`${t}/albums/${i}/videos/${s}/comments/${o}/replies?${(0,e7.Ov)(a)}&fields=${r.map(e7.Rb).join(",")}`,tt(tt({},l),{},{method:"POST",body:JSON.stringify((0,e7.mH)(n))}));if(!c.ok)throw new e7.F7("A network error occurred",c.status,c);if(204===c.status)return null;if(!c.headers.get("content-type")?.match(/^application\/(.+)?json$/))throw Error("Expected JSON response");let d=await c.json();return(0,e7.l_)(d)}var tn=r(296638),ti=r(848568);function ts(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function to(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ts(Object(r),!0).forEach(function(t){(0,i.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ts(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function ta(){let{mutate:e}=(0,tn.kY)(),{baseUrl:t,jwt:r,xVimeoPage:n,locale:i}=(0,ti.r)(),[o,a]=(0,e3.AC)();return[(0,s.useCallback)(async s=>{a({type:"REQUEST"});try{let o=await e(`/albums/${s.where.albumId}/videos/${s.where.videoId}/comments/${s.where.commentId}/replies${(0,e3.Y$)(s)}`,tr(to(to({},s),{},{baseUrl:t,headers:to(to({},s.headers),{},{"Content-Type":"application/json",Authorization:r?`jwt ${r}`:"","Vimeo-Page":`${n}`,"Accept-Language":i??"en"})})),!1);a({type:"SUCCESS",payload:o})}catch(e){a({type:"FAILURE",payload:e})}},[t,n,r,i,a]),o]}"true"===r(173656).env.STORYBOOK&&(0,e3.MR)(ta,{endpoint:"/albums/:albumId/videos/:videoId/comments/:commentId/replies",method:"POST"});let tl=["baseUrl","select","where","query"],tc=["baseUrl","select","variables","where","query"];function td(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function tu(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?td(Object(r),!0).forEach(function(t){(0,i.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):td(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}async function tp(e){let{baseUrl:t,select:r,where:{videoId:n,commentId:i},query:s}=e,o=(0,e4.Z)(e,tl),a=await fetch(`${t}/videos/${n}/comments/${i}/replies?${(0,e7.Ov)(s)}&fields=${r.map(e7.Rb).join(",")}`,tu(tu({},o),{},{method:"GET"}));if(!a.ok)throw new e7.F7("A network error occurred",a.status,a);if(204===a.status)return null;if(!a.headers.get("content-type")?.match(/^application\/(.+)?json$/))throw Error("Expected JSON response");let l=await a.json();return(0,e7.l_)(l)}async function tm(e){let{baseUrl:t,select:r,variables:n,where:{videoId:i,commentId:s},query:o}=e,a=(0,e4.Z)(e,tc),l=await fetch(`${t}/videos/${i}/comments/${s}/replies?${(0,e7.Ov)(o)}&fields=${r.map(e7.Rb).join(",")}`,tu(tu({},a),{},{method:"POST",body:JSON.stringify((0,e7.mH)(n))}));if(!l.ok)throw new e7.F7("A network error occurred",l.status,l);if(204===l.status)return null;if(!l.headers.get("content-type")?.match(/^application\/(.+)?json$/))throw Error("Expected JSON response");let c=await l.json();return(0,e7.l_)(c)}var th=r(512959),tg=r(173656);let tf=["perPage","page"];function ty(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function tj(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ty(Object(r),!0).forEach(function(t){(0,i.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ty(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function tv(){let{baseUrl:e,jwt:t,xVimeoPage:r,locale:n}=(0,ti.r)(),[i,o]=(0,e3.AC)();return[(0,s.useCallback)(async i=>{o({type:"REQUEST"});try{let s=await tm(tj(tj({},i),{},{baseUrl:e,headers:tj(tj({},i.headers),{},{"Content-Type":"application/json",Authorization:t?`jwt ${t}`:"","Vimeo-Page":`${r}`,"Accept-Language":n??"en"})}));o({type:"SUCCESS",payload:s})}catch(e){o({type:"FAILURE",payload:e})}},[e,r,t,n,o]),i]}"true"===tg.env.STORYBOOK&&(0,e3.MR)(function(e,t){let r="function"==typeof e?e():e,{baseUrl:n,jwt:i,xVimeoPage:s,locale:o}=(0,ti.r)();return(0,tn.ZP)(r?`/videos/${r.where.videoId}/comments/${r.where.commentId}/replies${(0,e3.Y$)(r)}`:()=>null,r?()=>tp(tj(tj({},r),{},{headers:tj(tj({},r.headers),{},{"Content-Type":"application/json",Authorization:i?`jwt ${i}`:"","Vimeo-Page":`${s}`,"Accept-Language":o??"en"}),baseUrl:n})):null,t)},{endpoint:"/videos/:videoId/comments/:commentId/replies",method:"GET"}),"true"===tg.env.STORYBOOK&&(0,e3.MR)(function(){let{mutate:e}=(0,tn.kY)(),{baseUrl:t,jwt:r,xVimeoPage:n,locale:i}=(0,ti.r)(),[o,a]=(0,e3.AC)();return[(0,s.useCallback)(async s=>{a({type:"REQUEST"});try{let o=await e(`/videos/${s.where.videoId}/comments/${s.where.commentId}/replies${(0,e3.Y$)(s)}`,tp(tj(tj({},s),{},{baseUrl:t,headers:tj(tj({},s.headers),{},{"Content-Type":"application/json",Authorization:r?`jwt ${r}`:"","Vimeo-Page":`${n}`,"Accept-Language":i??"en"})})));a({type:"SUCCESS",payload:o})}catch(e){a({type:"FAILURE",payload:e})}},[t,n,r,i,a]),o]},{endpoint:"/videos/:videoId/comments/:commentId/replies",method:"GET"}),"true"===tg.env.STORYBOOK&&(0,e3.MR)(function(e,t){let r="function"==typeof e?e():e,{baseUrl:n,jwt:i,xVimeoPage:s,locale:o}=(0,ti.r)();return(0,th.ZP)((e,t)=>{if(null===r||t&&!t.paging.next)return null;let n=r.query??{},{perPage:i=25,page:s}=n,o=(0,e4.Z)(n,tf),a=r.select.join(","),l=Object.entries(o??{}).filter(([,e])=>void 0!==e).map(([e,t])=>`${e}=${t}`).join("&");return[`/videos/${r.where.videoId}/comments/${r.where.commentId}/replies?page=${e+1}&perPage=${i}&fields=${a}&${l}`,e]},null!==r?([e,t])=>tp(tj(tj({},r),{},{baseUrl:n,headers:tj(tj({},r.headers),{},{"Content-Type":"application/json",Authorization:i?`jwt ${i}`:"","Vimeo-Page":`${s}`,"Accept-Language":o??"en"}),query:tj(tj({},r.query),{},{page:t+1})})):null,t)},{endpoint:"/videos/:videoId/comments/:commentId/replies",method:"GET"}),"true"===tg.env.STORYBOOK&&(0,e3.MR)(tv,{endpoint:"/videos/:videoId/comments/:commentId/replies",method:"POST"});let tb=["baseUrl","select","where","query"],tx=["baseUrl","select","variables","where"];function tO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function tw(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?tO(Object(r),!0).forEach(function(t){(0,i.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tO(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}async function tC(e){let{baseUrl:t,select:r,where:{videoId:n,commentId:i},query:s}=e,o=(0,e4.Z)(e,tb),a=await fetch(`${t}/videos/${n}/private_comments/${i}/replies?${(0,e7.Ov)(s)}&fields=${r.map(e7.Rb).join(",")}`,tw(tw({},o),{},{method:"GET"}));if(!a.ok)throw new e7.F7("A network error occurred",a.status,a);if(204===a.status)return null;if(!a.headers.get("content-type")?.match(/^application\/(.+)?json$/))throw Error("Expected JSON response");let l=await a.json();return(0,e7.l_)(l)}async function tP(e){let{baseUrl:t,select:r,variables:n,where:{videoId:i,commentId:s}}=e,o=(0,e4.Z)(e,tx),a=await fetch(`${t}/videos/${i}/private_comments/${s}/replies?fields=${r.map(e7.Rb).join(",")}`,tw(tw({},o),{},{method:"POST",body:JSON.stringify((0,e7.mH)(n))}));if(!a.ok)throw new e7.F7("A network error occurred",a.status,a);if(204===a.status)return null;if(!a.headers.get("content-type")?.match(/^application\/(.+)?json$/))throw Error("Expected JSON response");let l=await a.json();return(0,e7.l_)(l)}var tk=r(173656);let tR=["perPage","page"];function tI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function tS(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?tI(Object(r),!0).forEach(function(t){(0,i.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tI(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function tE(){let{baseUrl:e,jwt:t,xVimeoPage:r,locale:n}=(0,ti.r)(),[i,o]=(0,e3.AC)();return[(0,s.useCallback)(async i=>{o({type:"REQUEST"});try{let s=await tP(tS(tS({},i),{},{baseUrl:e,headers:tS(tS({},i.headers),{},{"Content-Type":"application/json",Authorization:t?`jwt ${t}`:"","Vimeo-Page":`${r}`,"Accept-Language":n??"en"})}));o({type:"SUCCESS",payload:s})}catch(e){o({type:"FAILURE",payload:e})}},[e,r,t,n,o]),i]}"true"===tk.env.STORYBOOK&&(0,e3.MR)(function(e,t){let r="function"==typeof e?e():e,{baseUrl:n,jwt:i,xVimeoPage:s,locale:o}=(0,ti.r)();return(0,tn.ZP)(r?`/videos/${r.where.videoId}/private_comments/${r.where.commentId}/replies${(0,e3.Y$)(r)}`:()=>null,r?()=>tC(tS(tS({},r),{},{headers:tS(tS({},r.headers),{},{"Content-Type":"application/json",Authorization:i?`jwt ${i}`:"","Vimeo-Page":`${s}`,"Accept-Language":o??"en"}),baseUrl:n})):null,t)},{endpoint:"/videos/:videoId/private_comments/:commentId/replies",method:"GET"}),"true"===tk.env.STORYBOOK&&(0,e3.MR)(function(){let{mutate:e}=(0,tn.kY)(),{baseUrl:t,jwt:r,xVimeoPage:n,locale:i}=(0,ti.r)(),[o,a]=(0,e3.AC)();return[(0,s.useCallback)(async s=>{a({type:"REQUEST"});try{let o=await e(`/videos/${s.where.videoId}/private_comments/${s.where.commentId}/replies${(0,e3.Y$)(s)}`,tC(tS(tS({},s),{},{baseUrl:t,headers:tS(tS({},s.headers),{},{"Content-Type":"application/json",Authorization:r?`jwt ${r}`:"","Vimeo-Page":`${n}`,"Accept-Language":i??"en"})})));a({type:"SUCCESS",payload:o})}catch(e){a({type:"FAILURE",payload:e})}},[t,n,r,i,a]),o]},{endpoint:"/videos/:videoId/private_comments/:commentId/replies",method:"GET"}),"true"===tk.env.STORYBOOK&&(0,e3.MR)(function(e,t){let r="function"==typeof e?e():e,{baseUrl:n,jwt:i,xVimeoPage:s,locale:o}=(0,ti.r)();return(0,th.ZP)((e,t)=>{if(null===r||t&&!t.paging.next)return null;let n=r.query??{},{perPage:i=25,page:s}=n,o=(0,e4.Z)(n,tR),a=r.select.join(","),l=Object.entries(o??{}).filter(([,e])=>void 0!==e).map(([e,t])=>`${e}=${t}`).join("&");return[`/videos/${r.where.videoId}/private_comments/${r.where.commentId}/replies?page=${e+1}&perPage=${i}&fields=${a}&${l}`,e]},null!==r?([e,t])=>tC(tS(tS({},r),{},{baseUrl:n,headers:tS(tS({},r.headers),{},{"Content-Type":"application/json",Authorization:i?`jwt ${i}`:"","Vimeo-Page":`${s}`,"Accept-Language":o??"en"}),query:tS(tS({},r.query),{},{page:t+1})})):null,t)},{endpoint:"/videos/:videoId/private_comments/:commentId/replies",method:"GET"}),"true"===tk.env.STORYBOOK&&(0,e3.MR)(tE,{endpoint:"/videos/:videoId/private_comments/:commentId/replies",method:"POST"});var tT=r(291615),tD=r(480225),tN=r(734528),t$=r(420426),t_=r(650269),tL=r(680795),tA=r(839179),tF=r(261840),tz=r(552599);function tK(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function tM(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?tK(Object(r),!0).forEach(function(t){(0,i.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tK(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var tU=r(495173),tZ=r(275733),tV=r(918879),tB=r(853842);function tJ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function tq(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?tJ(Object(r),!0).forEach(function(t){(0,i.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tJ(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let tH=["baseUrl","where"],tG=["baseUrl","select","variables","where"];function tY(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function tQ(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?tY(Object(r),!0).forEach(function(t){(0,i.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tY(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}async function tW(e){let{baseUrl:t,where:{videoId:r,commentId:n,replyId:i}}=e,s=(0,e4.Z)(e,tH),o=await fetch(`${t}/videos/${r}/private_comments/${n}/replies/${i}`,tQ(tQ({},s),{},{method:"DELETE"}));if(!o.ok)throw new e7.F7("A network error occurred",o.status,o);if(204===o.status)return null;if(!o.headers.get("content-type")?.match(/^application\/(.+)?json$/))throw Error("Expected JSON response");let a=await o.json();return(0,e7.l_)(a)}async function tX(e){let{baseUrl:t,select:r,variables:n,where:{videoId:i,commentId:s,replyId:o}}=e,a=(0,e4.Z)(e,tG),l=await fetch(`${t}/videos/${i}/private_comments/${s}/replies/${o}?fields=${r.map(e7.Rb).join(",")}`,tQ(tQ({},a),{},{method:"PATCH",body:JSON.stringify((0,e7.mH)(n))}));if(!l.ok)throw new e7.F7("A network error occurred",l.status,l);if(204===l.status)return null;if(!l.headers.get("content-type")?.match(/^application\/(.+)?json$/))throw Error("Expected JSON response");let c=await l.json();return(0,e7.l_)(c)}var t0=r(173656);function t1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function t2(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?t1(Object(r),!0).forEach(function(t){(0,i.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t1(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function t5(){let{mutate:e}=(0,tn.kY)(),{baseUrl:t,jwt:r,xVimeoPage:n,locale:i}=(0,ti.r)(),[o,a]=(0,e3.AC)();return[(0,s.useCallback)(async s=>{a({type:"REQUEST"});try{let o=await e(`/videos/${s.where.videoId}/private_comments/${s.where.commentId}/replies/${s.where.replyId}${(0,e3.Y$)(s)}`,tW(t2(t2({},s),{},{baseUrl:t,headers:t2(t2({},s.headers),{},{"Content-Type":"application/json",Authorization:r?`jwt ${r}`:"","Vimeo-Page":`${n}`,"Accept-Language":i??"en"})})),!1);a({type:"SUCCESS",payload:o})}catch(e){a({type:"FAILURE",payload:e})}},[t,n,r,i,a]),o]}function t6(){let{mutate:e}=(0,tn.kY)(),{baseUrl:t,jwt:r,xVimeoPage:n,locale:i}=(0,ti.r)(),[o,a]=(0,e3.AC)();return[(0,s.useCallback)(async s=>{a({type:"REQUEST"});try{let o=await e(`/videos/${s.where.videoId}/private_comments/${s.where.commentId}/replies/${s.where.replyId}${(0,e3.Y$)(s)}`,tX(t2(t2({},s),{},{baseUrl:t,headers:t2(t2({},s.headers),{},{"Content-Type":"application/json",Authorization:r?`jwt ${r}`:"","Vimeo-Page":`${n}`,"Accept-Language":i??"en"})})),!1);a({type:"SUCCESS",payload:o})}catch(e){a({type:"FAILURE",payload:e})}},[t,n,r,i,a]),o]}function t9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function t3(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?t9(Object(r),!0).forEach(function(t){(0,i.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t9(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}"true"===t0.env.STORYBOOK&&(0,e3.MR)(t5,{endpoint:"/videos/:videoId/private_comments/:commentId/replies/:replyId",method:"DELETE"}),"true"===t0.env.STORYBOOK&&(0,e3.MR)(t6,{endpoint:"/videos/:videoId/private_comments/:commentId/replies/:replyId",method:"PATCH"});var t4=r(8297);function t7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function t8(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?t7(Object(r),!0).forEach(function(t){(0,i.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t7(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var re=r(777179),rt=r.n(re);let rr=(e,t,r)=>(0,s.useMemo)(()=>{if(e)return{filteredComments:t};let n=rt()(t),i=r&&r?.toLowerCase()||"",s=0;return{filteredComments:n?.filter(e=>{if(e.deletedOn&&e?.replies?.length===0)return!1;let t=!e.deletedOn&&t$.Or(i,e.text);t&&s++;let r=e.replies?.filter(e=>{let t=t$.Or(i,e.text);return t&&s++,t}),n=r&&r.length>0;return t||n}),matchCount:s}},[t,r,e]);var rn=r(559278),ri=r(45093);let rs=e=>{let[t,{loading:r,error:n}]=(0,ri.r)(),{mutate:i}=(0,tA.C)(e);return{saveViewerPageCommentPreference:async r=>t({where:{videoId:e},select:["page"],variables:{page:{comments:r}}}).then(()=>{i()}),loading:r,error:n}};function ro(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}let ra=({children:e})=>{let t=(0,tF.l)(),r=(0,ti.r)(),{guestUser:n}=(0,s.useContext)(t_.hf),i=n?JSON.parse(n)?.guestUserJwt:null;return(0,f.jsx)(ti.G,{xVimeoPage:r.xVimeoPage,baseUrl:r.baseUrl,locale:r.locale,jwt:i&&!t?i:r.jwt,children:e})};var rl=r(557823);let rc=(e,t)=>{let[r,n]=(0,rl.Z)(t,e),{0:i,1:o}=(0,s.useState)(r);return[i,(0,s.useCallback)(e=>{o(e),n(e)},[n])]};var rd=r(833770),ru=r(594),rp=r(103514),rm=r(567848);let rh=({isActive:e,setActive:t,isLoading:r,onShowClick:n})=>(0,f.jsxs)(A.u,{isOpen:e,onClose:()=>t(!1),isCentered:!0,size:"md",children:[(0,f.jsx)(F.Z,{}),(0,f.jsxs)(z.h,{children:[(0,f.jsx)(rm.o,{}),(0,f.jsx)(K.x,{children:(0,ez.Iu)({singular:"Show comments on the video page",dictionary:{es:{singular:"Mostrar los comentarios en la p\xe1gina del video"},"de-DE":{singular:"Kommentare auf der Videoseite anzeigen"},"fr-FR":{singular:"Afficher les commentaires sur la page de la vid\xe9o"},"ja-JP":{singular:"動画ページにコメントを表示"},"ko-KR":{singular:"동영상 페이지에 댓글 표시"},"pt-BR":{singular:"Mostrar coment\xe1rios na p\xe1gina do v\xeddeo"},"zh-CN":{singular:"在视频页面上显示评论"}}})}),(0,f.jsx)(M.f,{children:(0,ez.Iu)({singular:"Comments will be turned on in Appearance settings, making them visible to viewers on the video page",dictionary:{es:{singular:"Los comentarios se activar\xe1n en la configuraci\xf3n de Apariencia, lo que los har\xe1 visibles para los espectadores en la p\xe1gina del video"},"de-DE":{singular:"Kommentare werden in den Darstellungseinstellungen aktiviert, sodass sie f\xfcr Zuschauende auf der Videoseite sichtbar sind"},"fr-FR":{singular:"Les commentaires seront activ\xe9s dans les param\xe8tres d'apparence, les rendant visibles pour les spectateurs sur la page de la vid\xe9o"},"ja-JP":{singular:"外観設定でコメントがオンになり、動画ページで視聴者にコメントが表示されるようになります"},"ko-KR":{singular:"모양 설정에서 댓글 기능을 활성화하면 동영상 페이지에서 뷰어가 댓글을 볼 수 있습니다."},"pt-BR":{singular:"Os coment\xe1rios ser\xe3o ativados nas configura\xe7\xf5es de Apar\xeancia, tornando-os vis\xedveis para os espectadores na p\xe1gina do v\xeddeo"},"zh-CN":{singular:"评论将在“外观”设置中开启，观众可以在视频页面上看到评论。"}}})}),(0,f.jsx)(U.m,{children:(0,f.jsxs)(L.U,{children:[(0,f.jsx)(p.z,{variant:"tertiary",onClick:()=>t(!1),children:(0,ez.Iu)({singular:"Cancel",dictionary:{es:{singular:"Cancelar"},"de-DE":{singular:"Abbrechen"},"fr-FR":{singular:"Annuler"},"ja-JP":{singular:"キャンセル"},"ko-KR":{singular:"취소"},"pt-BR":{singular:"Cancelar"},"zh-CN":{singular:"取消"}}})}),(0,f.jsx)(p.z,{variant:"primary",isLoading:r,onClick:()=>n(),children:(0,ez.Iu)({singular:"Show comments",dictionary:{es:{singular:"Mostrar los comentarios"},"de-DE":{singular:"Kommentare anzeigen"},"fr-FR":{singular:"Afficher les commentaires"},"ja-JP":{singular:"コメントを表示する"},"ko-KR":{singular:"소감 표시"},"pt-BR":{singular:"Mostrar coment\xe1rios"}}})})]})})]})]});function rg(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function rf(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?rg(Object(r),!0).forEach(function(t){(0,i.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rg(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let ry=(0,t_.qy)((n=({clipRequestId:e,clipId:t,isPublic:r,searchQuery:n="",onMomentPlay:i,analyticsProps:u,isUserProfileClickable:p=!0,saveViewerCommentsSetting:m,setSearchCommentCount:h,showCommentsHiddenAlert:g=!1,videoVersionUri:j,targetApiVersion:v,isPreviousVersion:b=!1,onReportClick:x,showcaseId:O})=>{let w=(0,o.pm)(),C=(0,tF.R)(),k=function(){let{0:e,1:t}=(0,s.useState)("");return(0,s.useEffect)(()=>{let e=document.querySelector('meta[name="bp-server-session-id"]');e?t(e.getAttribute("content")??""):t("")},[]),e}(),{videoData:R,videoDataLoading:I}=(0,tA.C)(e),[E,T]=rc({value:"newest",label:(0,ez.Iu)({singular:"Newest",dictionary:{es:{singular:"Los m\xe1s nuevos"},"de-DE":{singular:"Neueste"},"fr-FR":{singular:"Plus r\xe9centes"},"ja-JP":{singular:"新着順"},"ko-KR":{singular:"최신"},"pt-BR":{singular:"Mais recentes"},"zh-CN":{singular:"最新"}}}),type:"date",direction:"desc"},"comments-container-sort"),D={status:"open",userType:"everyone",mentionAndReplies:!1,videoVersionUri:j,targetApiVersion:v},{0:N,1:$}=(0,s.useState)(D),{initialPage:_,initialPageLoading:L,deeplinkNoteId:A,deeplinkDataError:F}=(0,rn.wz)(e,r,E,O),z=(0,t$.YK)(),{comments:K,commentsLoading:M,loadMoreComments:U,isLoadingMoreComments:Z,isCommentsDone:V,page:B,copyComment:J,commentsError:q}=(0,tz.hb)(e,r,E,N,O),{changeCommentsCount:H}=(0,e6.I2)(e,r,{videoVersionUri:j,targetApiVersion:v},O),{privacy:G}=(0,tB.V)(e),{guestUser:Y,modalState:{isActive:Q}}=(0,s.useContext)(t_.hf),{filteredComments:W,matchCount:X}=rr(!!(!n||M||K&&0===K.length),K,n),ee=!r||r&&G?.comments!=="nobody",[et,er,en]=function(e,t){let{0:r,1:n}=(0,s.useState)(t||1),i=(0,s.useRef)(null);return[r,(0,s.useCallback)(t=>{e&&(i.current&&i.current.disconnect(),i.current=new IntersectionObserver(t=>{t[0].isIntersecting&&e&&n(e=>e+1)}),t&&i.current.observe(t))},[e]),n]}(!V&&!M&&!Z&&!n,B),{0:ei,1:es}=(0,s.useState)(z||A),eo=(0,ru.K)(),{value:ea,set:el,remove:ec}=(0,e2.Z)(tN.bn,null,void 0,eo),ed=()=>{w({status:"error",title:(0,ez.Iu)({singular:"Unable to delete comment",dictionary:{es:{singular:"No se pudo eliminar el comentario"},"de-DE":{singular:"Kommentar kann nicht gel\xf6scht werden"},"fr-FR":{singular:"Impossible de supprimer le commentaire"},"ja-JP":{singular:"コメントを削除できません"},"ko-KR":{singular:"소감을 삭제할 수 없습니다."},"pt-BR":{singular:"N\xe3o foi poss\xedvel excluir o coment\xe1rio"},"zh-CN":{singular:"无法删除评论"}}})})};(0,s.useEffect)(()=>{B>et&&en(B),et>B&&U(et)},[B,U,et,en]),(0,s.useEffect)(()=>{_&&_>0&&en(_)},[_,en]);let{setComments:eu}=(0,s.useContext)(e5.B);(0,s.useEffect)(()=>{!r&&K&&eu(K)},[K,r,eu]),(0,s.useEffect)(()=>{h&&h(X)},[h,X]);let{postComment:ep,postCommentLoading:em,postCommentError:eh}=(0,e9.PU)(e,r,E,u,N,O),{deleteComment:eg,deleteCommentLoading:ef}=function(e,t,r,n,i,s,o){let{videoData:a}=(0,tA.C)(e);return(r?function(e,t,r,n,i,s,o){let[a,l]=(0,tZ.qM)(),[c,d]=(0,tU.m)(),{loading:u,error:p}=o?d:l,{privacy:m}=(0,tB.V)(e),{revalidateComments:h}=(0,tz.dD)(e,n,s,o),{revalidateCommentCount:g}=(0,e6.UC)(e,{shouldFetch:!0},o),f=(0,tF.R)(),y=(0,t$.D1)(e),j=(0,tT.l)(e),v=async t=>{await a(tq({where:{videoId:e,commentId:(0,t$.Pd)(t)}},j?{query:{password:j}}:{})),x(t)},b=async t=>{if(!o)return;let r=(0,t$.BO)(o);await c(tq({where:{albumId:o,videoId:e,commentId:(0,t$.Pd)(t)}},r?{query:{password:r}}:{})),x(t)},x=e=>{if(p&&!u&&t(),!u&&!p){if(i){let t=tq(tq({},i),{},{commentContextFields:{comment_id:(0,t$.Pd)(e),is_reply:!1}});(0,tD.MO)(y,m?.view,!0,t,f,null,r?.uploader?.link)}h(),g()}};return{deleteComment:o?b:v,deleteCommentLoading:u,deleteCommentError:p}}:function(e,t,r,n,i,s){let[o,{loading:a,error:l}]=(0,tV.o)(),{privacy:c}=(0,tB.V)(e),{revalidateComments:d}=(0,tz.O_)(e,n,s),{revalidateCommentCount:u}=(0,e6.ih)(e,{shouldFetch:!0,videoVersionUri:s?.videoVersionUri,targetApiVersion:s?.targetApiVersion}),p=(0,tF.R)(),m=(0,t$.D1)(e),h=(e,n)=>{if(l&&!a&&t(),!a&&!l){if(i){let t=tq(tq({},i),{},{commentContextFields:{comment_id:(0,t$.Pd)(e),is_reply:!1}});(0,tD.MO)(m,c?.view,!1,t,p,n,r?.uploader?.link)}d(),u()}};return{deleteComment:async(t,r)=>{await o({where:{videoId:e,commentId:(0,t$.Pd)(t)}}),h(t,r)},deleteCommentLoading:a,deleteCommentError:l}})(e,t,a,n,i,s,o)}(e,ed,r,E,u,N,O),{deleteReply:ey,deleteReplyLoading:ej}=(r?function(e,t,r,n,i,s){let o=(0,tF.R)(),a=(0,t$.D1)(e),{privacy:l}=(0,tB.V)(e),[c,d]=(0,tZ.qM)(),[u,p]=(0,tU.m)(),{loading:m,error:h}=s?p:d,{revalidateComments:g}=(0,tz.dD)(e,r,i,s),{revalidateCommentCount:f}=(0,e6.UC)(e,{shouldFetch:!0},s),y=(0,tT.l)(e),j=async t=>{await c(t3({where:{videoId:e,commentId:(0,t$.Pd)(t)}},y?{query:{password:y}}:{})),b(t)},v=async t=>{if(!s)return;let r=(0,t$.BO)(s);await u(t3({where:{albumId:s,videoId:e,commentId:(0,t$.Pd)(t)}},r?{query:{password:r}}:{})),b(t)},b=e=>{if(!m&&h&&t(),!m&&!h&&n){let t=t3(t3({},n),{},{commentContextFields:{comment_id:(0,t$.Pd)(e),is_reply:!0}});(0,tD.MO)(a,l?.view,!0,t,o,null)}g(),f()};return{deleteReply:s?v:j,deleteReplyLoading:m,deleteReplyError:h}}:function(e,t,r,n,i){let s=(0,tF.R)(),o=(0,t$.D1)(e),{privacy:a}=(0,tB.V)(e),[l,{loading:c,error:d}]=t5(),{revalidateComments:u}=(0,tz.O_)(e,r,i),{revalidateCommentCount:p}=(0,e6.ih)(e,{shouldFetch:!0,videoVersionUri:i?.videoVersionUri,targetApiVersion:i?.targetApiVersion}),m=(e,r)=>{if(!c&&d&&t(),!c&&!d){if(n){let t=t3(t3({},n),{},{commentContextFields:{comment_id:(0,t$.Pd)(e),is_reply:!0}});(0,tD.MO)(o,a?.view,!1,t,s,r)}u(),p()}};return{deleteReply:async(t,r)=>{await l({where:{videoId:e,replyId:(0,t$.Pd)(t),commentId:(0,t$.b)(t)}}),m(t,r)},deleteReplyLoading:c,deleteReplyError:d}})(e,ed,E,u,N,O),{resolveComment:ev,unresolveComment:eb,updateCommentText:ex,editCommentLoading:eO,editCommentError:ew}=(0,t4.us)(e,r,E,u,N,O),{patchReply:eC,patchReplyLoading:eP,patchReplyError:ek}=function(e,t,r,n,i,o){let{videoData:a}=(0,tA.C)(e);return(t?function(e,t,r,n,i,o){let a=(0,tF.R)(),l=(0,t$.D1)(e),{privacy:c}=(0,tB.V)(e),[d,u]=(0,tZ.kS)(),[p,m]=(0,tU.M)(),{loading:h,error:g}=o?m:u,{revalidateComments:f}=(0,tz.dD)(e,r,i,o),{0:y,1:j}=(0,s.useState)(null),v=(0,tT.l)(e),b=async(t,r)=>{j(t),await d(t8({where:{videoId:e,commentId:(0,t$.Pd)(t)},variables:{richtext:r},select:tN.dp},v?{query:{password:v}}:{})),O(t,r)},x=async(t,r)=>{if(!o)return;j(t);let n=(0,t$.BO)(o);await p(t8({where:{albumId:o,videoId:e,commentId:(0,t$.Pd)(t)},variables:{richtext:r},select:tN.dp},n?{query:{password:n}}:{})),O(t,r)},O=(e,r)=>{if(!h&&!g){if(n){let i=(0,t$.ZG)(r),s=t8(t8({},n),{},{commentContextFields:{comment_id:(0,t$.Pd)(e),is_reply:!0,comment_length:r?.length,is_mention:i}});(0,tD.Or)(l,c?.view,!0,s,a,!1,t?.uploader?.link)}f(t=>t?.filter(e=>!!e).map(t=>t8(t8({},t),{},{data:t.data?.map(t=>t8(t8({},t),{},{replies:t.replies?.map(t=>t.uri===e?t8(t8({},t),{},{text:r}):t)}))})))}};return{patchReply:o?x:b,patchReplyLoading:h,patchReplyError:g?{errorMessage:(0,ez.Iu)({singular:"Unable to edit reply",dictionary:{es:{singular:"No se puede editar la respuesta"},"de-DE":{singular:"Bearbeitung der Antwort nicht m\xf6glich"},"fr-FR":{singular:"Impossible de modifier la r\xe9ponse"},"ja-JP":{singular:"返信を編集できません"},"ko-KR":{singular:"답글을 편집할 수 없습니다."},"pt-BR":{singular:"N\xe3o foi poss\xedvel editar a resposta"},"zh-CN":{singular:"无法编辑回复"}}}),errorCommentId:y}:null}}:function(e,t,r,n,i){let o=(0,tF.R)(),[a,{loading:l,error:c}]=t6(),{privacy:d}=(0,tB.V)(e),{revalidateComments:u}=(0,tz.O_)(e,r,i),{0:p,1:m}=(0,s.useState)(null),h=async(t,r)=>{m(t),await a({where:{videoId:e,commentId:(0,t$.b)(t),replyId:(0,t$.Pd)(t)},variables:{richtext:r},select:["text","richtext","uri","metadata.connections.user","createdTime","metadata","timeCode","userName"]}),f(t,r)},g=(0,t$.D1)(e),f=(e,r)=>{if(!l&&!c){if(n){let i=(0,t$.ZG)(r),s=t8(t8({},n),{},{commentContextFields:{comment_id:(0,t$.Pd)(e),is_reply:!0,comment_length:r?.length,is_mention:i}});(0,tD.Or)(g,d?.view,!1,s,o,!1,t?.uploader?.link)}u(t=>t?.filter(e=>!!e).map(t=>t8(t8({},t),{},{data:t.data?.map(t=>t8(t8({},t),{},{replies:t.replies.map(t=>t.uri===e?t8(t8({},t),{},{text:r}):t)}))})))}};return{patchReply:h,patchReplyLoading:l,patchReplyError:c?{errorMessage:(0,ez.Iu)({singular:"Unable to edit reply",dictionary:{es:{singular:"No se puede editar la respuesta"},"de-DE":{singular:"Bearbeitung der Antwort nicht m\xf6glich"},"fr-FR":{singular:"Impossible de modifier la r\xe9ponse"},"ja-JP":{singular:"返信を編集できません"},"ko-KR":{singular:"답글을 편집할 수 없습니다."},"pt-BR":{singular:"N\xe3o foi poss\xedvel editar a resposta"},"zh-CN":{singular:"无法编辑回复"}}}),errorCommentId:p}:null}})(e,a,r,n,i,o)}(e,r,E,u,N,O),{postReply:eR,postReplyLoading:eI,postReplyError:eS}=(r?function(e,t,r,n,i){let o=(0,t$.D1)(e),{revalidateComments:a}=(0,tz.dD)(e,t,n,i),[l,c]=tv(),[d,u]=ta(),{data:p,loading:m,error:h}=i?u:c,{videoData:g}=(0,tA.C)(e),f=g?.privacy.view,y=(0,tF.l)(),{toggleGuestLoginModal:j,guestUser:v}=(0,s.useContext)(t_.hf),b=y||!!v,{toggleLoginModal:x,setRedirectUrl:O}=(0,tL.NK)(),w=(0,tT.l)(e),{0:C,1:P}=(0,s.useState)(null),k=async(t,r)=>{if(b||"unlisted"!==f){if(!b){O(window.location.pathname+window.location.search),x(!0);return}}else{j(!0);return}let n={richtext:t};if(P(r),i){let t=(0,t$.BO)(i);await d(tM({where:{albumId:i,videoId:e,commentId:(0,t$.Pd)(r)},select:tN.Fl,variables:n},t?{query:{password:t}}:{}))}else await l(tM({where:{videoId:e,commentId:(0,t$.Pd)(r)},select:tN.Fl,variables:n},w?{query:{password:w}}:{}))};return(0,s.useEffect)(()=>{if(!m&&!h&&p&&C){let e=Number((g?.uploader?.link||"").match(/user(\d+)/)?.[1]||0);a(t=>t?.filter(e=>!!e).map(t=>tM(tM({},t),{},{data:t.data?.map(t=>{if(t.uri===C){let n=t$.ZG(p.text||"");if(r){let i=tM(tM({},r),{},{commentContextFields:{comment_id:t$.Pd(p.uri),is_reply:!0,comment_owner_id:y?.user?.id??-1,comment_length:p.text.length,is_mention:n,existing_reply_counts:t.replies.length}});tD.TC(o,f,e,i,y)}t.replies=[...t.replies,p]}return t}),total:t.total?t.total+1:0}))),P(null)}},[p,m,a,C,h,g?.uploader?.link,g?.privacy.view,o,y,r,f]),{postReply:k,postReplyLoading:m,postReplyError:h?{errorMessage:(0,ez.Iu)({singular:"Unable to post reply",dictionary:{es:{singular:"No se pudo publicar la respuesta"},"de-DE":{singular:"Es ist nicht m\xf6glich, eine Antwort zu hinterlassen"},"fr-FR":{singular:"Impossible de R\xe9pondre \xe0 un commentaire"},"ja-JP":{singular:"返信を投稿できませんでした"},"ko-KR":{singular:"답글 추가 불가"},"pt-BR":{singular:"N\xe3o Foi Poss\xedvel Postar Uma Resposta"},"zh-CN":{singular:"无法发布回复"}}}),errorCommentId:C}:null}}:function(e,t,r,n){let i=(0,tF.l)(),o=(0,t$.D1)(e),{0:a,1:l}=(0,s.useState)(null),[c,{data:d,loading:u,error:p}]=tE(),{revalidateComments:m}=(0,tz.O_)(e,t,n),{videoData:h}=(0,tA.C)(e),{toggleGuestLoginModal:g,guestUser:f}=(0,s.useContext)(t_.hf),y=i||!!f,j=async(t,r,n)=>{if(!y){g(!0);return}let s=n??i?.user?.name;l(r),await c({where:{videoId:e,commentId:(0,t$.Pd)(r)},select:["text","richtext","uri","metadata.connections.user","createdTime","metadata","timeCode","userName"],variables:{richtext:t,name:s}})};return(0,s.useEffect)(()=>{if(!u&&!p&&d&&a){let e=Number((h?.uploader?.link||"").match(/user(\d+)/)?.[1]||0),t=h?.privacy.view;m(n=>n?.filter(e=>!!e).map(n=>tM(tM({},n),{},{data:n.data?.map(n=>{if(n.uri===a){if(r){let s=t$.ZG(d?.richtext||d?.text||""),a=tM(tM({},r),{},{commentContextFields:{comment_id:t$.Pd(d.uri),is_reply:!0,comment_owner_id:i?.user?.id??-1,comment_length:d.text.length,is_mention:s,existing_reply_counts:n.replies.length}});tD.TC(o,t,e,a,i,!1,!1)}n.replies=[...n.replies,d],"closed"===n.status&&(n.status="open")}return n}),total:n.total?n.total+1:0}))),l(null)}},[d,p,u,m,a,h?.uploader?.link,h?.privacy.view,o,i,r]),{postReply:j,postReplyLoading:u,postReplyError:p?{errorMessage:(0,ez.Iu)({singular:"Unable to post reply",dictionary:{es:{singular:"No se pudo publicar la respuesta"},"de-DE":{singular:"Es ist nicht m\xf6glich, eine Antwort zu hinterlassen"},"fr-FR":{singular:"Impossible de R\xe9pondre \xe0 un commentaire"},"ja-JP":{singular:"返信を投稿できませんでした"},"ko-KR":{singular:"답글 추가 불가"},"pt-BR":{singular:"N\xe3o Foi Poss\xedvel Postar Uma Resposta"},"zh-CN":{singular:"无法发布回复"}}}),errorCommentId:a}:null}})(e,E,u,N,O),eE=(0,s.useCallback)(t=>(0,f.jsx)(rp.b,rf(rf({clipRequestId:e},t),{},{analyticsProps:u,showcaseId:O})),[e,u,I,Y]),{canEdit:eT}=(0,rd.Q)(e),eD=e=>{en(1),$(rf(rf({},N),e))};(0,s.useEffect)(()=>{let e=JSON.parse(ea);(C?.user||Y)&&e?.text&&!I&&!em&&!eI&&(ec(),(e.isReply?eR(e.text,e.commentId):ep(e.text)).then(()=>H?.increaseCommentsCount()))},[C?.user,r,I,em,eI,Y]);let{0:eN,1:e$}=(0,s.useState)(!1),{saveViewerPageCommentPreference:e_,loading:eL}=rs(e),eA=(0,s.useRef)(""),eF=R&&R.page&&!R.page.comments,eK=!R?.metadata?.interactions?.edit?.uri&&R?.metadata?.interactions?.canComment;return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)(l.k,{justifyContent:r?"flex-end":"space-between",px:{base:200,md:300},py:"8px",children:[!r&&(0,f.jsx)(y,{showResolved:N?.status!=="open",updateFilterOptions:e=>{eD(e),u&&(0,tD.kp)(!e.status,t,G?.view,u,C)}}),(0,f.jsxs)(l.k,{children:[(0,f.jsx)(P,{defaultSort:E.label,isPublic:r,setSort:e=>{T(e)},onSortSelect:e=>{u&&(0,tD.WR)(e.value,t,G?.view,R?.uploader.link,r,u,C)}}),(0,f.jsx)(S,{filterOptions:N,updateFilterOptions:e=>{u&&(0,tD._x)(t$.Xg[e.userType??"mentions_replies"].option,t$.Xg[e.userType??"mentions_replies"].copy,t,r,G?.view,u,C),eD(e)},isLoggedOut:!C?.user})]})]}),b&&(0,f.jsx)(l.k,{px:{base:200,md:300},children:(0,f.jsx)(c.bZ,{display:"flex",alignItems:"center",status:"info",size:"sm",children:(0,f.jsx)(d.x,{fontSize:"body-sm",children:(0,ez.Iu)({singular:"To add a comment, {LINK}view the current version{/LINK}",replacements:{LINK:t=>(0,f.jsx)(a.r,{fontSize:"body-sm",variant:"inline-primary",href:`/manage/videos/${e}`,_hover:{cursor:"pointer"},children:t})},dictionary:{es:{singular:"Para agregar un comentario, {LINK}ver la versi\xf3n actual{/LINK}"},"de-DE":{singular:"Um einen Kommentar hinzuzuf\xfcgen, {LINK}sehen Sie sich die aktuelle Version an{/LINK}"},"fr-FR":{singular:"Pour ajouter un commentaire, {LINK}consultez la version actuelle{/LINK}"},"ja-JP":{singular:"コメントを追加するには、{LINK}現在のバージョンを表示します{/LINK}"},"ko-KR":{singular:"댓글을 추가하려면 {LINK}현재 버전을 확인하세요{/LINK}."},"pt-BR":{singular:"Para adicionar um coment\xe1rio, {LINK}visualize a vers\xe3o atual{/LINK}"},"zh-CN":{singular:"要添加评论，请{LINK}查看当前版本{/LINK}"}}})})})}),r&&eF&&g&&!b&&(0,f.jsx)(l.k,{px:{base:200,md:300},children:(0,f.jsx)(c.bZ,{status:"info",children:(0,f.jsxs)(d.x,{display:"inline",fontSize:"body-sm",children:[(0,ez.Iu)({singular:"Viewer comments are currently hidden on the video page.",dictionary:{es:{singular:"En este momento, los comentarios de los espectadores est\xe1n ocultos en la p\xe1gina del video."},"de-DE":{singular:"Kommentare der Zuschauenden sind derzeit auf der Videoseite verborgen."},"fr-FR":{singular:"Les commentaires des spectateurs sont actuellement masqu\xe9s sur la page de la vid\xe9o."},"ja-JP":{singular:"視聴者のコメントは現在、動画ページで非表示になっています。"},"ko-KR":{singular:"현재 동영상 페이지에서 뷰어 댓글이 숨김 상태로 설정되어 있습니다."},"pt-BR":{singular:"No momento, os coment\xe1rios dos espectadores est\xe3o ocultos na p\xe1gina do v\xeddeo."},"zh-CN":{singular:"目前视频页面上的观众评论被隐藏。"}}}),(0,f.jsx)(a.r,{fontSize:"body-sm",variant:"inline-primary",onClick:()=>e$(!0),pl:"4px",_hover:{cursor:"pointer"},children:(0,ez.Iu)({singular:"Show comments",dictionary:{es:{singular:"Mostrar los comentarios"},"de-DE":{singular:"Kommentare anzeigen"},"fr-FR":{singular:"Afficher les commentaires"},"ja-JP":{singular:"コメントを表示する"},"ko-KR":{singular:"소감 표시"},"pt-BR":{singular:"Mostrar coment\xe1rios"}}})})]})})}),(0,f.jsx)(eX,{comments:W,toggleCommentStatus:(e,t)=>{"closed"===t?eb(e):ev(e)},isPublic:r,addReply:(e,t,r)=>{let n=(0,t$.uv)(t);C?.user||Y||el(JSON.stringify({text:n,isReply:!0,commentId:e,name:r})),eR(n,e,r).then(()=>H?.increaseCommentsCount()),es(null)},deleteComment:(e,t)=>{eg(e,t),es(null)},deleteReply:(e,t)=>{ey(e,t),es(null)},editComment:(e,t)=>{ex(e,(0,t$.uv)(t)),es(null)},editReply:(e,t)=>{eC(e,(0,t$.uv)(t)),es(null)},lastElementRef:er,canAddComments:ee,deeplinkedCommentId:ei?.toString(),isCommentsLoading:M||L,isSubmitTextLoading:eI||eO||eP,isDeleteLoading:ef||ej,isMoreCommentsLoading:Z||!1,richCommentComponent:eE,onCopyClick:(e,n,i,s,o)=>{J(e,s);let a=(0,t$.ZG)(o);u&&(u=rf(rf({},u),{},{commentContextFields:{comment_id:(0,t$.Pd)(e),is_reply:!!s,comment_owner_id:(0,t$.Pd)(n),is_mention:a}}),(0,tD.xH)(t,G?.view,R?.uploader.link,r,u,C,i))},onOpenCommentOptionsClick:(e,n,i,s)=>{u&&(u=rf(rf({},u),{},{commentContextFields:{comment_id:(0,t$.Pd)(e),is_reply:n,comment_owner_id:(0,t$.Pd)(i)}}),(0,tD.OD)(t,G?.view,R?.uploader.link,r,u,C,s))},isUserProfileClickable:p,onUserProfileClick:(e,r,n)=>{u&&(u=rf(rf({},u),{},{commentContextFields:{comment_id:(0,t$.Pd)(e),is_reply:r,comment_owner_id:(0,t$.Pd)(n)}}),(0,tD.lo)(t,k,u,C))},commentsFetchingError:q||F,editCommentError:ew,editReplyError:ek,replyError:eS,onMomentPlay:i,canResolveComment:eT,searchQuery:n,appliedFilter:N?.userType!=="everyone"||N?.mentionAndReplies===!0,clearFilters:()=>{eD(D)},saveViewerCommentsSetting:m,isGuestModalActive:Q,hasOnlyCommentAccess:eK,isPreviousVersion:b,onReportClick:x,videoPrivacy:G?.view}),(0,f.jsx)(e1,{richCommentComponent:eE,isLoading:em,isPublic:r,onSubmit:e=>{let t=(0,t$.uv)(e);C?.user||Y||el(JSON.stringify({text:t,isReply:!1})),ep(t).then(()=>H?.increaseCommentsCount()),es(null)},canAddComments:ee,hasComments:!!K?.length,errorMessage:eh?.errorMessage,saveViewerCommentsSetting:m,isGuestModalActive:Q,hasOnlyCommentAccess:eK,isPreviousVersion:b}),(0,f.jsx)(rh,{isActive:eN,setActive:e$,isLoading:eL,onShowClick:()=>{e_(!0).then(()=>{e$(!1),eA.current=w({title:(0,ez.Iu)({singular:"Comments turned on in Appearance settings. {LINK}Undo{/LINK}",replacements:{LINK:e=>(0,f.jsx)(a.r,{color:"inherit",_hover:{cursor:"pointer",_dark:{color:"inherit"}},onClick:()=>{w.close(eA.current),e_(!1)},fontSize:"body-md",variant:"inline-primary",children:e})},dictionary:{es:{singular:"Los comentarios est\xe1n activados en la configuraci\xf3n de Apariencia. {LINK}Deshacer{/LINK}"},"de-DE":{singular:"Kommentare wurden in den Auftrittseinstellungen aktiviert. {LINK}R\xfcckg\xe4ngig machen{/LINK}"},"fr-FR":{singular:"Commentaires activ\xe9s dans les param\xe8tres d'apparence. {LINK}Annuler{/LINK}"},"ja-JP":{singular:"外観設定でコメントがオンになっています。{LINK}元に戻す{/LINK}"},"ko-KR":{singular:"모양 설정에서 댓글이 활성화되었습니다. {LINK}실행 취소{/LINK}"},"pt-BR":{singular:"Coment\xe1rios ativados nas configura\xe7\xf5es de Apar\xeancia. {LINK}Desfazer{/LINK}"},"zh-CN":{singular:"在外观设置中启用了评论。{LINK}撤销{/LINK}"}}}),duration:3e3})}).catch(()=>{w({title:(0,ez.Iu)({singular:"Unable to turn on comments. {LINK}Try again{/LINK}",replacements:{LINK:e=>(0,f.jsx)(a.r,{color:"inherit",onClick:()=>e$(!0),_hover:{cursor:"pointer",_dark:{color:"inherit"}},fontSize:"body-md",variant:"inline-primary",children:e})},dictionary:{es:{singular:"No se pueden activar los comentarios. {LINK}Vuelva a intentarlo{/LINK}"},"de-DE":{singular:"Kommentare k\xf6nnen nicht aktiviert werden. {LINK}Erneut versuchen{/LINK}"},"fr-FR":{singular:"Impossible d'activer les commentaires. {LINK}R\xe9essayez{/LINK}"},"ja-JP":{singular:"コメントをオンにできませんでした。{LINK}もう一度お試しください{/LINK}"},"ko-KR":{singular:"댓글을 활성화할 수 없습니다. {LINK}다시 시도하세요.{/LINK}"},"pt-BR":{singular:"N\xe3o foi poss\xedvel ativar os coment\xe1rios. {LINK}Tente novamente{/LINK}"},"zh-CN":{singular:"无法开启评论。{LINK}请重试{/LINK}"}}}),duration:3e3})})}})]})},e=>(0,f.jsx)(ra,{children:(0,f.jsx)(n,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ro(Object(r),!0).forEach(function(t){(0,i.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ro(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},e))})))},559278:function(e,t,r){r.d(t,{wz:function(){return c}});var n=r(652983),i=r(271870),s=r(165152),o=r(649094),a=r(291615),l=r(420426);function c(e,t,r,c){let d=(0,l.vh)(),u=function(e,t,r,o,c){let{0:d,1:u}=(0,n.useState)(!1),p=(0,s.gV)(()=>{if(d||!t||!o?.shouldFetch||c)return null;let n=(0,a.l)(e);return{query:(0,l.KK)(t,n,r),where:{videoId:e},select:["uri"]}}),m=(0,i.bG)(()=>{if(d||!t||!o?.shouldFetch||!c)return null;let n=(0,l.BO)(c);return{query:(0,l.KK)(t,n,r),where:{albumId:c,videoId:e},select:["uri"]}}),{data:h,error:g}=c?m:p;(0,n.useEffect)(()=>{h&&!d&&(u(!0),f.current=h.page)},[h,d]);let f=(0,n.useRef)(h?.page);return t?{initialPage:f.current,initialPageLoading:!d,deeplinkNoteId:t,deeplinkDataError:g}:{initialPage:1,initialPageLoading:!1,deeplinkNoteId:null,deeplinkDataError:!1}}(e,d,r,{shouldFetch:t},c),p=function(e,t,r,i){let{0:s,1:a}=(0,n.useState)(!1),{data:l,error:c}=(0,o.cz)(()=>!s&&t&&i?.shouldFetch?{query:{noteId:t,sort:r?.type,direction:r?.direction,includeDeletedComments:!0,status:"open"},where:{videoId:e},select:["uri"]}:null);(0,n.useEffect)(()=>{l&&!s&&(a(!0),d.current=l.page)},[l,s]);let d=(0,n.useRef)(l?.page);return t?{initialPage:d.current,initialPageLoading:!s,deeplinkNoteId:t,deeplinkDataError:c}:{initialPage:1,initialPageLoading:!1,deeplinkNoteId:null,deeplinkDataError:!1}}(e,d,r,{shouldFetch:!t});return t?u:p}},567313:function(e,t,r){r.d(t,{n:function(){return R}});var n=r(867932),i=r(92575),s=r(652983),o=r(844578),a=r(670296),l=r(751004),c=r(662555),d=r(397458);let u=()=>(0,d.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",viewBox:"0 0 32 32",children:(0,d.jsx)("g",{children:(0,d.jsx)("g",{id:"staffpicks_layer_1",children:(0,d.jsxs)("g",{children:[(0,d.jsx)("circle",{cx:"16",cy:"16",r:"16"}),(0,d.jsxs)("g",{children:[(0,d.jsx)("path",{className:"path-1",d:"M20.47,9.32h-3.81v13.35h1.91v-5.72h1.91c1.05,0,1.91-.85,1.91-1.91v-3.81c0-1.05-.85-1.91-1.91-1.91ZM18.57,15.05h1.91v-3.81h-1.91v3.81Z"}),(0,d.jsx)("path",{className:"path-1",d:"M15.39,13.14v-1.91c0-1.05-.85-1.91-1.91-1.91h-1.91c-1.05,0-1.91.85-1.91,1.91v3.81c0,1.05.85,1.91,1.91,1.91h1.91v3.81h-1.91v-1.91h-1.91v1.91c0,1.05.85,1.91,1.91,1.91h1.91c1.05,0,1.91-.85,1.91-1.91v-3.81c0-1.05-.85-1.91-1.91-1.91h-1.91v-3.81h1.91v1.91h1.91Z"})]}),(0,d.jsxs)("g",{children:[(0,d.jsx)("path",{className:"path-2",d:"M5.18,14.92c-.49.37-.94.8-1.38,1.28-.45-.46-.88-.98-1.27-1.54.1-1.04.32-2.06.66-3.05.25.64.54,1.24.88,1.79.53-.37,1.08-.67,1.64-.93-.27.79-.45,1.61-.53,2.45Z"}),(0,d.jsx)("path",{className:"path-2",d:"M5.4,18.42c-.35.51-.65,1.06-.91,1.65-.58-.29-1.15-.65-1.69-1.06-.23-1.02-.34-2.06-.34-3.1.45.52.91,1,1.41,1.42.39-.51.82-.98,1.26-1.4,0,.84.09,1.68.27,2.49Z"}),(0,d.jsx)("path",{className:"path-2",d:"M6.72,21.66c-.16.59-.27,1.21-.33,1.85-.64-.09-1.29-.25-1.94-.46-.55-.89-.99-1.84-1.32-2.83.59.36,1.18.65,1.79.89.21-.61.46-1.19.75-1.73.26.79.62,1.56,1.06,2.27Z"}),(0,d.jsx)("path",{className:"path-2",d:"M9,24.32c.04.61.13,1.23.27,1.87-.63.11-1.3.17-1.99.17-.8-.67-1.52-1.43-2.14-2.27.67.15,1.33.24,1.97.28,0-.65.05-1.27.16-1.88.5.67,1.08,1.29,1.72,1.83Z"}),(0,d.jsx)("path",{className:"path-2",d:"M6.08,11.54c-.58.2-1.15.46-1.72.77-.28-.58-.52-1.21-.71-1.86.43-.95.97-1.85,1.6-2.68.03.68.12,1.34.26,1.98.62-.18,1.24-.3,1.85-.35-.51.66-.94,1.39-1.29,2.15Z"}),(0,d.jsx)("path",{className:"path-1",d:"M7.02,6.59c-.37.73-.67,1.47-.88,2.21.64-.43,1.32-.77,1.98-1.05.31-.66.69-1.3,1.15-1.93-.75.19-1.5.44-2.25.78Z"})]}),(0,d.jsxs)("g",{children:[(0,d.jsx)("path",{className:"path-2",d:"M29.47,14.66c-.38.56-.82,1.08-1.27,1.54-.44-.48-.89-.9-1.38-1.28-.08-.83-.26-1.66-.53-2.45.55.25,1.11.56,1.64.93.34-.55.63-1.15.88-1.79.34.99.56,2.01.66,3.05Z"}),(0,d.jsx)("path",{className:"path-2",d:"M29.2,19.01c-.54.41-1.11.76-1.69,1.06-.26-.59-.56-1.14-.91-1.65.19-.82.28-1.65.27-2.49.44.42.87.88,1.26,1.4.5-.42.96-.89,1.41-1.42,0,1.04-.11,2.08-.34,3.1Z"}),(0,d.jsx)("path",{className:"path-2",d:"M27.55,23.05c-.65.21-1.3.37-1.94.46-.06-.64-.17-1.26-.33-1.85.44-.71.79-1.48,1.06-2.27.28.53.54,1.11.75,1.73.6-.24,1.19-.54,1.79-.89-.33.99-.77,1.94-1.32,2.83Z"}),(0,d.jsx)("path",{className:"path-2",d:"M24.71,26.36c-.69,0-1.35-.07-1.99-.17.14-.64.23-1.26.27-1.87.64-.54,1.22-1.15,1.72-1.83.11.6.16,1.23.16,1.88.64-.04,1.31-.13,1.97-.28-.62.84-1.34,1.6-2.14,2.27Z"}),(0,d.jsx)("path",{className:"path-2",d:"M28.35,10.45c-.19.66-.43,1.28-.71,1.86-.57-.31-1.14-.57-1.72-.77-.34-.76-.78-1.49-1.29-2.15.61.06,1.23.18,1.85.35.14-.63.23-1.3.26-1.98.63.83,1.17,1.73,1.6,2.68Z"}),(0,d.jsx)("path",{className:"path-1",d:"M23.87,7.75c.67.28,1.34.63,1.98,1.05-.21-.74-.51-1.48-.88-2.21-.75-.34-1.5-.59-2.25-.78.45.63.84,1.28,1.15,1.93Z"})]})]})})})});var p=r(356105),m=r(467426),h=r(297715),g=r(560583),f=r(923801),y=r(411594),j=r(126371);function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let x=()=>({pageName:"viewer_home",videoPrivacy:"public",isTeamMember:!1,teamOwnerId:null});function O(e){var t;let r="view"===e.event?"vimeo.view_sp_badge":"vimeo.select_sp_badge",n="click"===e.event?(0,m.kD)({action_type:"click",feature:null}):(0,p.Mw)({view_type:"impression",feature:null}),{videoId:i,userUri:s,feature:o,location:a,videoPrivacy:l,sessionId:c,pageName:d,isTeamMember:u,teamOwnerId:v}=b(b({},x()),e),O=parseInt(s?.split("/")[2]??0,10);(0,j.Ou)(r,b(b(b(b(b(b({},n),(0,h.Qt)({video_id:i,video_owner_id:O,video_privacy:l})),(0,h.Qt)({video_id:i,viewer_home_session_id:c})),function(e,t=null,r=null){return(0,g.g9)({page_name:e,referrer_page_name:t,path:window.location.pathname,referrer:r})}(d)),(0,f.UW)({is_team_member:u,team_owner_id:v})),(t="viewer_home",(0,y.FI)({product:t,feature:o,location:a,modal_name:null,flow:null,element:null,copy:"sp",device_type:null,entity_type:"user"}))),1)}let w=["href","onClick","children"];function C(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function P(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?C(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let k=e=>{let{href:t,onClick:r,children:n}=e,s=(0,i.Z)(e,w);return t||r?(0,d.jsx)("a",P(P({style:{display:"inline-flex"},href:t,onClick:r,target:"_blank",rel:"noreferrer"},s),{},{children:n})):(0,d.jsx)(d.Fragment,{children:n})};function R({radius:e,href:t,videoId:r,userUri:n,feature:i,onClick:p,marginRight:m=8}){let h=function(){let{0:e,1:t}=(0,s.useState)("");return(0,s.useEffect)(()=>{let e=document.querySelector('meta[name="bp-server-session-id"]');e?t(e.getAttribute("content")??""):t("")},[]),parseInt(e,10)}(),g="profile"===i?"video_details_panel":"comments_panel",f={videoId:r,userUri:n,sessionId:h,feature:i,location:g};(0,s.useEffect)(()=>{O(P({event:"view"},{videoId:r,userUri:n,sessionId:h,feature:i,location:g}))},[r,n,h,i,g]);let y=(0,o.ff)("#000000","#FFFFFF"),j=(0,o.ff)("#FFFFFF","#000000");return(0,d.jsx)(a.u,{label:(0,c.Iu)({singular:"View Staff Picks",dictionary:{es:{singular:"Ver Staff Picks"},"de-DE":{singular:"Staff Picks anzeigen"},"fr-FR":{singular:"Voir les Staff Picks"},"ja-JP":{singular:"スタッフピックを表示"},"ko-KR":{singular:"스태프 픽 보기"},"pt-BR":{singular:"Ver Staff Picks"},"zh-CN":{singular:"查看 Staff Picks"}}}),placement:"top",children:(0,d.jsx)(l.xu,{display:"inline-flex",alignSelf:"center",marginRight:m,sx:{"& svg":{width:`${e??18}`,height:`${e??18}`},"& circle":{fill:`${y}`},"& .path-1":{fillRule:"evenodd"},"& .path-1,& .path-2":{fill:`${j}`}},children:(0,d.jsx)(k,{href:t,onClick:()=>{O(P({event:"click"},f)),p&&p()},"aria-label":(0,c.Iu)({singular:"View Staff Picks",dictionary:{es:{singular:"Ver Staff Picks"},"de-DE":{singular:"Staff Picks anzeigen"},"fr-FR":{singular:"Voir les Staff Picks"},"ja-JP":{singular:"スタッフピックを表示"},"ko-KR":{singular:"스태프 픽 보기"},"pt-BR":{singular:"Ver Staff Picks"},"zh-CN":{singular:"查看 Staff Picks"}}}),children:(0,d.jsx)(u,{})})})})}}}]);
//# sourceMappingURL=26757-ac4911116e9bd884.js.map